(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{488:function(t,e,n){"use strict";n(4);var r={data:function(){return{dialog:!1,resolve:null,reject:null,message:null,title:null,options:{color:"primary",width:290,zIndex:200}}},computed:{show:{get:function(){return this.dialog},set:function(t){this.dialog=t,!1===t&&this.cancel()}}},methods:{open:function(title,t,e){var n=this;return this.dialog=!0,this.title=title,this.message=t,this.options=Object.assign(this.options,e),new Promise((function(t,e){n.resolve=t,n.reject=e}))},agree:function(){this.resolve(!0),this.dialog=!1,this.$emit("onOk")},cancel:function(){this.dialog=!1,this.resolve(!1),this.$emit("onCancel")}}},o=n(41),c=n(50),l=n.n(c),d=n(110),v=n(183),f=n(62),m=n(485),h=n(481),component=Object(o.a)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-dialog",{style:{zIndex:t.options.zIndex},attrs:{"max-width":t.options.width},on:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"esc",27,e.key,["Esc","Escape"])?null:t.cancel(e)}},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[n("v-card",[n("h2",{staticClass:"pl-6 pt-3 pb-2"},[t._v(t._s(t.title))]),t._v(" "),n("v-card-text",{directives:[{name:"show",rawName:"v-show",value:!!t.message,expression:"!!message"}]},[t._v(" "+t._s(t.message)+" ")]),t._v(" "),n("v-card-actions",[n("v-spacer"),t._v(" "),n("v-btn",{attrs:{color:t.options.color,text:""},nativeOn:{click:function(e){return t.agree(e)}}},[t._v(" ใช่ ")]),t._v(" "),n("v-btn",{attrs:{color:"grey",text:""},nativeOn:{click:function(e){return t.cancel(e)}}},[t._v(" ไม่ ")])],1)],1)],1)}),[],!1,null,null,null);e.a=component.exports;l()(component,{VBtn:d.a,VCard:v.a,VCardActions:f.a,VCardText:f.c,VDialog:m.a,VSpacer:h.a})},634:function(t,e,n){"use strict";n.r(e);n(122),n(42);var r=n(7),o=n(86),c=n.n(o),l={data:function(){return{assignModal:!1,status:[{label:"พักรายการ",value:"pending"},{label:"ทำรายการสำเร็จ",value:"success"},{label:"ยกเลิกรายการ",value:"cancel"}],selectStatus:"pending",startMenuDate:!1,endMenuDate:!1,nowDate:(new Date).toISOString().substr(0,10),startDate:c()().subtract(3,"months").format("YYYY-MM-DD"),endDate:(new Date).toISOString().substr(0,10)}},computed:{start:function(){return this.startDate?c()(this.startDate).format("DD/MM/YYYY"):null},end:function(){return this.endDate?c()(this.endDate).format("DD/MM/YYYY"):null}},watch:{startDate:function(t){null!==this.endDate&&this.emitDate()},endDate:function(t){null!==this.startDate&&this.emitDate()},selectStatus:function(t){localStorage.posState=t,null!==this.startDate&&null!==this.startDate&&this.emitDate()}},mounted:function(){void 0!==localStorage.posState&&(this.selectStatus=localStorage.posState)},methods:{emitDate:function(){this.$emit("updateStatus",{startDate:this.startDate,endDate:this.endDate,state:this.selectStatus})}}},d=n(41),v=n(50),f=n.n(v),m=n(183),h=n(641),x=n(465),w=n(112),D=n(120),k=n(466),_=n(475),S=n(504),y=n(481),$=n(527),O=n(461),component=Object(d.a)(l,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-card",{attrs:{color:"grey lighten-4",flat:"",tile:""}},[n("v-row",{class:"second-nav cusblue1 "+(this.$vuetify.breakpoint.xsOnly?"pb-2":""),attrs:{height:"55",align:"center",justify:"center",dense:"",flat:""}},[n("h1",{staticClass:"font-weight-medium col-sm-2 col-6 order-first"},[t._v("POS")]),t._v(" "),n("v-spacer"),t._v(" "),n("v-subheader",{directives:[{name:"show",rawName:"v-show",value:!this.$vuetify.breakpoint.smAndDown,expression:"!this.$vuetify.breakpoint.smAndDown"}],staticClass:"cus-subhead"},[t._v("\n      วันที่เริ่ม :\n    ")]),t._v(" "),n("v-menu",{ref:"menu",attrs:{"close-on-content-click":!1,transition:"scale-transition","offset-y":"","min-width":"290px"},scopedSlots:t._u([{key:"activator",fn:function(e){var r=e.on,o=e.attrs;return[n("v-text-field",t._g(t._b({staticClass:"rounded-lg cus-input mr-3",attrs:{"background-color":"cusblue3","append-icon":"mdi-calendar-month",dark:"",filled:"",rounded:"","single-line":"",dense:"",flat:"","hide-details":"",readonly:""},model:{value:t.start,callback:function(e){t.start=e},expression:"start"}},"v-text-field",o,!1),r))]}}]),model:{value:t.startMenuDate,callback:function(e){t.startMenuDate=e},expression:"startMenuDate"}},[t._v(" "),n("v-date-picker",{ref:"picker",attrs:{color:"cusblue",max:t.nowDate},model:{value:t.startDate,callback:function(e){t.startDate=e},expression:"startDate"}})],1),t._v(" "),n("v-subheader",{directives:[{name:"show",rawName:"v-show",value:!this.$vuetify.breakpoint.smAndDown,expression:"!this.$vuetify.breakpoint.smAndDown"}],staticClass:"cus-subhead"},[t._v("\n      วันที่สิ้นสุด :\n    ")]),t._v(" "),n("v-menu",{ref:"menu",attrs:{"close-on-content-click":!1,transition:"scale-transition","offset-y":"","min-width":"290px"},scopedSlots:t._u([{key:"activator",fn:function(e){var r=e.on,o=e.attrs;return[n("v-text-field",t._g(t._b({staticClass:"rounded-lg cus-input mr-3",attrs:{"background-color":"cusblue3","append-icon":"mdi-calendar-month",dark:"",filled:"",rounded:"","single-line":"",dense:"",flat:"","hide-details":"",readonly:""},model:{value:t.end,callback:function(e){t.end=e},expression:"end"}},"v-text-field",o,!1),r))]}}]),model:{value:t.endMenuDate,callback:function(e){t.endMenuDate=e},expression:"endMenuDate"}},[t._v(" "),n("v-date-picker",{ref:"picker",attrs:{color:"cusblue",max:t.nowDate},model:{value:t.endDate,callback:function(e){t.endDate=e},expression:"endDate"}})],1),t._v(" "),n("v-subheader",{directives:[{name:"show",rawName:"v-show",value:!this.$vuetify.breakpoint.smAndDown,expression:"!this.$vuetify.breakpoint.smAndDown"}],staticClass:"cus-subhead"},[t._v("\n      สถานะ :\n    ")]),t._v(" "),n("v-select",{class:t.$vuetify.breakpoint.xsOnly?"rounded-lg cus-input order-first":"rounded-lg cus-input",attrs:{items:t.status,"item-text":"label","item-value":"value","menu-props":{closeOnContentClick:!0},"background-color":"cusblue3","item-color":"cusblue",label:"ทั้งหมด",dark:"",filled:"",rounded:"","single-line":"",dense:"",flat:"","hide-details":""},scopedSlots:t._u([{key:"prepend-item",fn:function(){return[n("v-list-item",{style:""===t.selectStatus?"background-color: #e2f5fc":"",attrs:{ripple:""},on:{click:function(e){t.selectStatus=""}}},[n("v-list-item-content",[n("v-list-item-title",{class:""===t.selectStatus?"cusblue--text":""},[t._v("\n              แสดงทั้งหมด\n            ")])],1)],1),t._v(" "),n("v-divider",{staticClass:"mt-2"})]},proxy:!0}]),model:{value:t.selectStatus,callback:function(e){t.selectStatus=e},expression:"selectStatus"}})],1)],1)}),[],!1,null,null,null),C=component.exports;f()(component,{VCard:m.a,VDatePicker:h.a,VDivider:x.a,VListItem:w.a,VListItemContent:D.a,VListItemTitle:D.b,VMenu:k.a,VRow:_.a,VSelect:S.a,VSpacer:y.a,VSubheader:$.a,VTextField:O.a});var V={components:{confirmDialog:n(488).a},props:{posQueue:{type:Array,required:!1,default:null},state:{type:String,required:!0}},data:function(){return{confirmDel:!1,checkout:!1,headers:[{text:"ลำดับ",value:"id",align:"center",width:"100",sortable:!1,class:"font-weight-bold"},{text:"หมายเลขอ้างอิง",value:"refNumber",align:"center",width:"150",sortable:!1,class:"font-weight-bold"},{text:"ผู้ทำรายการ",value:"user",align:"center",width:"",sortable:!1},{text:"ลูกค้า",value:"customer",align:"center",width:"",sortable:!1},{text:"ทำรายการเมื่อ",value:"createAt",align:"center",width:"",sortable:!1},{text:"สถานะ",value:"state",align:"center",width:"",sortable:!1},{text:"จำนวนเงินสุทธิ",value:"netPrice",align:"right",width:"",sortable:!1},{text:"Action",value:"action",align:"center",width:"",sortable:!1}]}},methods:{orderNum:function(data,t){return data.map((function(t){return t.id})).indexOf(t)+1},delPOS:function(t){var e=this;this.$refs.confirm.open("คุณแน่ใจหรือไม่?","คุณแน่ใจหรือไม่ที่จะลบข้อมูลนี้",{width:290,color:"red"}).then((function(n){e.$axios.$delete("/api/pos/".concat(t),{progress:!1}).then((function(n){e.$emit("deletePOS",t)})).catch((function(t){alert(t)}))})).catch((function(){}))},getColor:function(t){return"cancel"===t?"rgb(255, 98, 98)":"pending"===t?"rgb(255, 191, 72)":"rgb(87, 243, 87)"}}},I=n(110),M=n(464),P=n(642),Y=n(184),A=Object(d.a)(V,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("v-data-table",{staticClass:"elevation-4 overflow-y-auto",attrs:{headers:t.headers,items:t.posQueue,"disable-pagination":"","hide-default-footer":"",height:"calc(100vh - 160px)","fixed-header":""},scopedSlots:t._u([{key:"item.id",fn:function(e){var r=e.item;return[n("div",{staticClass:"text-center"},[t._v("\n        "+t._s(t.orderNum(t.posQueue,r.id))+"\n      ")])]}},{key:"item.state",fn:function(e){var r=e.item;return[n("div",{staticClass:"text-center"},[n("v-chip",{attrs:{color:t.getColor(r.state),dark:"",small:"",label:""}},[t._v("\n          "+t._s(r.state)+"\n        ")])],1)]}},{key:"item.refNumber",fn:function(e){var r=e.item;return[n("div",{staticClass:"font-weight-medium"},[n("nuxt-link",{staticClass:"bold-owner text-decoration-none text-truncate",attrs:{to:"/pos/"+r.id}},[t._v("\n          "+t._s(r.receiptNumber||r.posNumber)+"\n          "),n("v-icon",{attrs:{color:"cusblue2",small:""}},[t._v("mdi-chevron-right")])],1)],1)]}},{key:"item.user",fn:function(e){var n=e.item;return[t._v("\n      "+t._s(n.receiptBy||n.createBy)+"\n    ")]}},{key:"item.createAt",fn:function(e){var n=e.item;return[t._v("\n      "+t._s(t.$moment(n.receiptAt||n.createAt).format("DD/MM/YYYY HH:mm:ss"))+"\n    ")]}},{key:"item.netPrice",fn:function(e){var n=e.item;return[t._v("\n      "+t._s(n.netPrice?(new Intl.NumberFormat).format(n.netPrice):"-")+"\n    ")]}},{key:"item.action",fn:function(e){var r=e.item;return[n("v-btn",{attrs:{disabled:"cancel"===r.state,icon:"",depressed:"","x-small":""},on:{click:function(e){return t.delPOS(r.id)}}},[n("v-icon",[t._v("mdi-trash-can")])],1)]}}],null,!0)}),t._v(" "),n("confirmDialog",{ref:"confirm"})],1)}),[],!1,null,null,null),N=A.exports;f()(A,{VBtn:I.a,VChip:M.a,VDataTable:P.a,VIcon:Y.a});var R={components:{posQueueNav:C,posQueue:N},validate:function(t){var e=t.store;return e.getters.loggedInUser.roles.some((function(t){return 6===t.id}))||e.getters.loggedInUser.isAdmin},asyncData:function(t){return Object(r.a)(regeneratorRuntime.mark((function e(){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.$axios,t.params,e.next=3,n.$get("/api/pos?state=pending&dateRange0=".concat(c()().subtract(3,"months").toISOString(),"&dateRange1=").concat(c()().toISOString()),{progress:!1});case 3:return r=e.sent,e.abrupt("return",{pos:r.results});case 5:case"end":return e.stop()}}),e)})))()},data:function(){return{select:"pending"}},methods:{addPosQueue:function(){var t=this;this.$axios.$post("/api/pos",null,{progress:!1}).then((function(e){t.$router.push("/pos/"+e.id)})).catch((function(t){alert(t)}))},updateStatus:function(t){var e=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var r,o,l;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e.select=t.state,r=c()(t.startDate).add(1,"days").toISOString(),o=c()(t.endDate).add(1,"days").toISOString(),n.next=5,e.$axios.$get("/api/pos?".concat(""!==t.state?"state=".concat(t.state,"&dateRange0=").concat(r,"&dateRange1=").concat(o):"states=pending&states=success&states=cancel&dateRange0=".concat(r,"&dateRange1=").concat(o)),{progress:!1});case 5:l=n.sent,e.pos=l.results;case 7:case"end":return n.stop()}}),n)})))()},deletePOS:function(t){var e=this.pos.findIndex((function(e){return e.id===t}));this.pos.splice(e,1)}}},j=Object(d.a)(R,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("posQueueNav",{on:{updateStatus:t.updateStatus}}),t._v(" "),n("div",{staticClass:"custom-container"},[n("posQueue",{attrs:{"pos-queue":t.pos,state:t.select},on:{deletePOS:t.deletePOS}})],1),t._v(" "),n("v-btn",{attrs:{color:"cusblue2",fixed:"",fab:"",small:this.$vuetify.breakpoint.mobile,large:!this.$vuetify.breakpoint.mobile,dark:"",bottom:"",right:""},on:{click:function(e){return e.stopPropagation(),t.addPosQueue(e)}}},[n("v-icon",[t._v("mdi-plus")])],1)],1)}),[],!1,null,null,null);e.default=j.exports;f()(j,{VBtn:I.a,VIcon:Y.a})}}]);