(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{488:function(e,t,n){"use strict";n(4);var o={data:function(){return{dialog:!1,resolve:null,reject:null,message:null,title:null,options:{color:"primary",width:290,zIndex:200}}},computed:{show:{get:function(){return this.dialog},set:function(e){this.dialog=e,!1===e&&this.cancel()}}},methods:{open:function(title,e,t){var n=this;return this.dialog=!0,this.title=title,this.message=e,this.options=Object.assign(this.options,t),new Promise((function(e,t){n.resolve=e,n.reject=t}))},agree:function(){this.resolve(!0),this.dialog=!1},cancel:function(){this.reject(!0),this.dialog=!1}}},r=n(41),l=n(50),c=n.n(l),d=n(110),v=n(184),m=n(62),f=n(484),h=n(480),component=Object(r.a)(o,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-dialog",{style:{zIndex:e.options.zIndex},attrs:{"max-width":e.options.width},on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"esc",27,t.key,["Esc","Escape"])?null:e.cancel(t)}},model:{value:e.show,callback:function(t){e.show=t},expression:"show"}},[n("v-card",[n("h2",{staticClass:"pl-6 pt-3 pb-2"},[e._v(e._s(e.title))]),e._v(" "),n("v-card-text",{directives:[{name:"show",rawName:"v-show",value:!!e.message,expression:"!!message"}]},[e._v(" "+e._s(e.message)+" ")]),e._v(" "),n("v-card-actions",[n("v-spacer"),e._v(" "),n("v-btn",{attrs:{color:e.options.color,text:""},nativeOn:{click:function(t){return e.agree(t)}}},[e._v(" ใช่ ")]),e._v(" "),n("v-btn",{attrs:{color:"grey",text:""},nativeOn:{click:function(t){return e.cancel(t)}}},[e._v(" ไม่ ")])],1)],1)],1)}),[],!1,null,null,null);t.a=component.exports;c()(component,{VBtn:d.a,VCard:v.a,VCardActions:m.a,VCardText:m.c,VDialog:f.a,VSpacer:h.a})},491:function(e,t,n){"use strict";var o=n(125),r=n(59),l=n(123),c=n(0),d=n(3),v=Object(d.a)(o.a,Object(r.a)("windowGroup","v-window-item","v-window"));t.a=v.extend().extend().extend({name:"v-window-item",directives:{Touch:l.a},props:{disabled:Boolean,reverseTransition:{type:[Boolean,String],default:void 0},transition:{type:[Boolean,String],default:void 0},value:{required:!1}},data:function(){return{isActive:!1,inTransition:!1}},computed:{classes:function(){return this.groupClasses},computedTransition:function(){return this.windowGroup.internalReverse?void 0!==this.reverseTransition?this.reverseTransition||"":this.windowGroup.computedTransition:void 0!==this.transition?this.transition||"":this.windowGroup.computedTransition}},methods:{genDefaultSlot:function(){return this.$slots.default},genWindowItem:function(){return this.$createElement("div",{staticClass:"v-window-item",class:this.classes,directives:[{name:"show",value:this.isActive}],on:this.$listeners},this.genDefaultSlot())},onAfterTransition:function(){this.inTransition&&(this.inTransition=!1,this.windowGroup.transitionCount>0&&(this.windowGroup.transitionCount--,0===this.windowGroup.transitionCount&&(this.windowGroup.transitionHeight=void 0)))},onBeforeTransition:function(){this.inTransition||(this.inTransition=!0,0===this.windowGroup.transitionCount&&(this.windowGroup.transitionHeight=Object(c.g)(this.windowGroup.$el.clientHeight)),this.windowGroup.transitionCount++)},onTransitionCancelled:function(){this.onAfterTransition()},onEnter:function(e){var t=this;this.inTransition&&this.$nextTick((function(){t.computedTransition&&t.inTransition&&(t.windowGroup.transitionHeight=Object(c.g)(e.clientHeight))}))}},render:function(e){var t=this;return e("transition",{props:{name:this.computedTransition},on:{beforeEnter:this.onBeforeTransition,afterEnter:this.onAfterTransition,enterCancelled:this.onTransitionCancelled,beforeLeave:this.onBeforeTransition,afterLeave:this.onAfterTransition,leaveCancelled:this.onTransitionCancelled,enter:this.onEnter}},this.showLazyContent((function(){return[t.genWindowItem()]})))}})},528:function(e,t,n){"use strict";var o=n(491);t.a=o.a.extend({name:"v-tab-item",props:{id:String},methods:{genWindowItem:function(){var e=o.a.options.methods.genWindowItem.call(this);return e.data.domProps=e.data.domProps||{},e.data.domProps.id=this.id||this.value,e}}})},564:function(e,t,n){"use strict";n(11),n(9),n(6),n(4),n(10);var o=n(1),r=(n(42),n(7));n(126),n(21);function l(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function c(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?l(Object(source),!0).forEach((function(t){Object(o.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):l(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var d={data:function(){var e=this;return{assignModal:!1,valid:!0,loading:!1,alert:!1,error:"",nameTitle:this.$store.state.form.prefixes,addCustomer:{id:"",prefix:1,f_name:"",l_name:"",houseNo:"",address:"",email:"",tel:[],other:""},rules:{prefix:[function(e){return!!e||"กรุณาใส่คำนำหน้าชื่อ"}],f_name:[function(e){return!!e||"กรุณากรอกชื่อ"},function(e){return e&&e.length<=100||"ไม่ควรกรอกชื่อเกิน 100 ตัวอักษร"}],l_name:[function(e){return!!e||"กรุณากรอกนามสกุล"},function(e){return e&&e.length<=100||"ไม่ควรกรอกนามสกุลเกิน 100 ตัวอักษร"}],houseNo:[function(e){return!!e||"กรุณากรอกบ้านเลขที่"},function(e){return e&&e.length<=300||"ไม่ควรกรอกบ้านเลขที่เกิน 50 ตัวอักษร"}],tel:[function(e){return!!e||"กรุณากรอกเบอร์โทรศัพท์"},function(t){return t&&e.validatePhone(t)||"กรุณากรอกเบอร์ให้ถูกรูปแบบ"}]}}},mounted:function(){var e=this;0===this.$store.state.form.prefixes.length&&this.$store.dispatch("form/addPrefixes").then((function(t){e.nameTitle=t})),this.socket=this.$nuxtSocket({reconnection:!0,reconnectionAttempts:5,reconnectionDelay:1e3,reconnectionDelayMax:5e3,randomizationFactor:.5}),this.socket.on("connect",(function(data){e.socket.emit("set-query",{query:["name","address","photo"]},(function(e){}))})),this.socket.on("disconnect",(function(){setTimeout((function(){e.socket.connect()}),1e3)}))},methods:{open:function(e){var t=this;this.assignModal=!0,this.$route.params.owner?this.addCustomer={id:e.id,prefix:e.prefixId||1,f_name:e.firstName,l_name:e.lastName,houseNo:e.houseNo,address:e.address,email:e.email,tel:e.tels,other:e.remark}:(this.socket.on("smc-data",(function(e){t.loading=!1;var n=e.data,o=n.name,r=o.prefix,l=o.firstname,c=o.lastname,d=n.address,v=d.houseNo,m=d.full;t.addCustomer={id:"",prefix:"นาย"===r?2:"นางสาว"===r?3:"นาง"===r?4:1,f_name:l,l_name:c,houseNo:v,address:m.substring(v.length+1),email:"",tel:[],other:""}})),this.socket.on("smc-error",(function(e){t.loading=!1,t.alert=!0,t.error="อ่านข้อมูลบัตรผิดพลาด ลองใหม่อีกครั้ง"})),this.socket.on("smc-removed",(function(e){t.loading=!1,t.alert=!1})),this.socket.on("smc-incorrect",(function(e){t.loading=!1,t.alert=!0,t.error="เสียบบัตรไม่ถูกต้อง"})),this.socket.on("smc-inserted",(function(e){t.loading=!0,t.alert=!1,t.error=""})))},cancelForm:function(){this.$refs.form.reset(),this.assignModal=!1},onEnter:function(e){this.$refs[e].focus()},validatePhone:function(e){if(0!==e.length)return e.every((function(e){return e.match(/^[0-9]{9,10}$/)}))},onSubmit:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var n,o,r,l;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.$refs.form.validate()){t.next=31;break}if(e.loading=!0,n=c({},e.addCustomer),o={prefixId:n.prefix,firstName:n.f_name,lastName:n.l_name,houseNo:n.houseNo,address:n.address,tels:n.tel,email:n.email,remark:n.other},r=!e.addCustomer.id,t.prev=5,l=null,!r){t.next=13;break}return t.next=10,e.$axios.$post("/api/members",o,{progress:!1});case 10:l=t.sent,t.next=16;break;case 13:return t.next=15,e.$axios.$patch("/api/members/".concat(n.id),o,{progress:!1});case 15:l=t.sent;case 16:if(e.loading=!1,e.assignModal=!1,e.alert=!1,e.$refs.form.reset(),r){t.next=23;break}return e.$emit("update",l),t.abrupt("return");case 23:e.$router.push("/record/".concat(l.id)),t.next=31;break;case 26:t.prev=26,t.t0=t.catch(5),e.loading=!1,e.alert=!0,e.error=t.t0.response?t.t0.response.data.error.message:t.t0.message;case 31:case"end":return t.stop()}}),t,null,[[5,26]])})))()}}},v=n(41),m=n(50),f=n.n(m),h=n(478),k=n(110),x=n(184),_=n(62),D=n(474),w=n(627),y=n(484),C=n(466),$=n(479),O=n(185),V=n(183),A=n(476),T=n(522),I=n(480),j=n(461),P=n(525),component=Object(v.a)(d,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("v-dialog",{attrs:{"max-width":"700",scrollable:"",fullscreen:this.$vuetify.breakpoint.xsOnly},model:{value:e.assignModal,callback:function(t){e.assignModal=t},expression:"assignModal"}},[n("v-card",[n("h2",{staticClass:"pa-5 pb-2"},[e._v("\n        "+e._s(e.addCustomer.id?"แก้ไขข้อมูลลูกค้า":"เพิ่มข้อมูลลูกค้า")+"\n      ")]),e._v(" "),n("v-btn",{staticClass:"mt-4",attrs:{icon:"",absolute:"",right:""},on:{click:function(t){e.assignModal=!1}}},[n("v-icon",[e._v("mdi-close")])],1),e._v(" "),n("v-divider",{staticClass:"darker-divider"}),e._v(" "),n("v-card-text",[n("v-form",{ref:"form",attrs:{"lazy-validation":"",autocomplete:"off"},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[n("div",[n("v-row",{attrs:{dense:""}},[n("v-col",{attrs:{cols:"12",sm:"4"}},[n("v-select",{attrs:{color:"cusblue",disabled:e.loading,items:e.nameTitle,"item-text":"label","item-value":"id",label:"คำนำหน้าชื่อ","menu-props":"auto",rules:e.rules.prefix,required:""},on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onEnter("f_name")}},model:{value:e.addCustomer.prefix,callback:function(t){e.$set(e.addCustomer,"prefix",t)},expression:"addCustomer.prefix"}})],1),e._v(" "),n("v-col",{attrs:{cols:"12",sm:"4"}},[n("v-text-field",{ref:"f_name",attrs:{disabled:e.loading,color:"cusblue",label:"ชื่อ",rules:e.rules.f_name,required:"",autofocus:""},on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onEnter("l_name")}},model:{value:e.addCustomer.f_name,callback:function(t){e.$set(e.addCustomer,"f_name",t)},expression:"addCustomer.f_name"}})],1),e._v(" "),n("v-col",{attrs:{cols:"12",sm:"4"}},[n("v-text-field",{ref:"l_name",attrs:{disabled:e.loading,color:"cusblue",label:"นามสกุล",rules:e.rules.l_name,required:""},on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onEnter("houseno")}},model:{value:e.addCustomer.l_name,callback:function(t){e.$set(e.addCustomer,"l_name",t)},expression:"addCustomer.l_name"}})],1),e._v(" "),n("v-col",{attrs:{cols:"4"}},[n("v-text-field",{ref:"houseno",attrs:{disabled:e.loading,color:"cusblue",label:"บ้านเลขที่",rules:e.rules.houseNo,required:""},on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onEnter("address")}},model:{value:e.addCustomer.houseNo,callback:function(t){e.$set(e.addCustomer,"houseNo",t)},expression:"addCustomer.houseNo"}})],1),e._v(" "),n("v-col",{attrs:{cols:"8"}},[n("v-text-field",{ref:"address",attrs:{disabled:e.loading,color:"cusblue",label:"ที่อยู่",rules:e.rules.address,required:""},on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onEnter("tel")}},model:{value:e.addCustomer.address,callback:function(t){e.$set(e.addCustomer,"address",t)},expression:"addCustomer.address"}})],1),e._v(" "),n("v-col",{attrs:{cols:"12"}},[n("v-combobox",{ref:"tel",attrs:{disabled:e.loading,color:"cusblue",label:"เบอร์ติดต่อ",height:"32","append-icon":"",rules:e.rules.tel,multiple:"","small-chips":"","deletable-chips":""},on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onEnter("email")}},model:{value:e.addCustomer.tel,callback:function(t){e.$set(e.addCustomer,"tel",t)},expression:"addCustomer.tel"}})],1),e._v(" "),n("v-col",{attrs:{cols:"12"}},[n("v-text-field",{ref:"email",attrs:{disabled:e.loading,color:"cusblue",label:"อีเมล์",rules:e.rules.email,required:""},on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onEnter("other")}},model:{value:e.addCustomer.email,callback:function(t){e.$set(e.addCustomer,"email",t)},expression:"addCustomer.email"}})],1),e._v(" "),n("v-col",{attrs:{cols:"12"}},[n("v-textarea",{ref:"other",attrs:{disabled:e.loading,color:"cusblue",label:"อื่นๆ","auto-grow":"","row-height":"24",rows:"1"},model:{value:e.addCustomer.other,callback:function(t){e.$set(e.addCustomer,"other",t)},expression:"addCustomer.other"}})],1)],1)],1)]),e._v(" "),n("v-alert",{attrs:{dense:"",text:"",color:"red",transition:"scroll-y-transition",dismissible:""},model:{value:e.alert,callback:function(t){e.alert=t},expression:"alert"}},[e._v("\n          "+e._s(e.error)+"\n        ")])],1),e._v(" "),n("v-card-actions",[n("v-spacer"),e._v(" "),n("v-btn",{directives:[{name:"shortkey",rawName:"v-shortkey",value:["ctrl","x"],expression:"['ctrl', 'x']"}],attrs:{disabled:e.loading,color:"cusblue2",text:""},on:{shortkey:e.cancelForm,click:e.cancelForm}},[e._v("\n          ยกเลิก\n        ")]),e._v(" "),n("v-btn",{directives:[{name:"shortkey",rawName:"v-shortkey",value:["ctrl","enter"],expression:"['ctrl', 'enter']"}],attrs:{color:"cusblue2",disabled:!e.valid||e.loading,text:""},on:{shortkey:e.onSubmit,click:e.onSubmit}},[n("v-progress-circular",{directives:[{name:"show",rawName:"v-show",value:e.loading,expression:"loading"}],staticClass:"mr-2",attrs:{indeterminate:"",color:"cusblue2",size:15,width:2}}),e._v("\n          บันทึก\n        ")],1)],1)],1)],1)],1)}),[],!1,null,null,null);t.a=component.exports;f()(component,{VAlert:h.a,VBtn:k.a,VCard:x.a,VCardActions:_.a,VCardText:_.c,VCol:D.a,VCombobox:w.a,VDialog:y.a,VDivider:C.a,VForm:$.a,VIcon:O.a,VProgressCircular:V.a,VRow:A.a,VSelect:T.a,VSpacer:I.a,VTextField:j.a,VTextarea:P.a})},566:function(e,t,n){"use strict";n(11),n(9),n(6),n(4),n(10);var o=n(1),r=(n(42),n(7)),l=n(86),c=n.n(l);function d(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}var v={data:function(){return{petId:"",appointDialog:!1,valid:!1,loading:!1,alert:!1,error:"",oldAppointDialog:!1,oldAppoint:[],menuDate:!1,AppointDate:!1,AppointTime:!1,appointType:this.$store.state.form.appointType,doctor:this.$store.state.form.doctor,plusBtn:[{text:"+3",value:3},{text:"+5",value:5},{text:"+7",value:7},{text:"+30",value:30}],sendAppoint:{petId:"",appointDate:"",appointTime:"",doctor:"",cause:"",remark:"",fromVisitId:""},rules:{appointDate:[function(e){return!!e||"กรุณาเลือกวันที่นัด"}],appointTime:[function(e){return!!e||"กรุณาเลือกเวลานัด"}],cause:[function(e){return!!e||"กรุณากรอกสาเหตุการนัด"},function(e){return e.length<=1e3||"ไม่ควรกรอกสาเหตุการนัด 1000 ตัวอักษร"}],remark:[function(e){return e.length<=1e3||"ไม่ควรกรอกหมายเหตุเกิน 1000 ตัวอักษร"}]}}},computed:{selectDate:function(){return this.sendAppoint.appointDate?c()(this.sendAppoint.appointDate).format("DD/MM/YYYY"):null}},mounted:function(){var e=this;0===this.$store.state.form.doctor.length&&this.$store.dispatch("form/addDoctor").then((function(t){e.doctor=t})),0===this.$store.state.form.appointType.length&&this.$store.dispatch("form/addappointType").then((function(t){e.appointType=t}))},methods:{open:function(e){var t=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var o;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t.sendAppoint.petId=e,t.sendAppoint.appointDate=(new Date).toISOString().substr(0,10),t.sendAppoint.appointTime=c()().format("HH:mm"),n.next=5,t.$axios.$get("/api/appoints?petId=".concat(e),{progress:!1});case 5:0!==(o=n.sent).results.length?(t.oldAppoint=o.results,t.oldAppointDialog=!0):t.appointDialog=!0;case 7:case"end":return n.stop()}}),n)})))()},addText:function(text){this.sendAppoint.cause=this.sendAppoint.cause+text},showAddDialog:function(){var e=this;this.oldAppointDialog=!1,setTimeout((function(){e.appointDialog=!0}),150)},plusDate:function(e){this.sendAppoint.appointDate=c()(this.sendAppoint.appointDate).add(e,"days").format("YYYY-MM-DD")},submitAppoint:function(){var e=this;if(this.$refs.form.validate()){this.loading=!0;var t=function(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?d(Object(source),!0).forEach((function(t){Object(o.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):d(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}({},this.sendAppoint),n={petId:t.petId,doctorId:""===t.doctor?null:t.doctor,appointDate:t.appointDate,appointTime:t.appointTime,cause:t.cause,remark:t.remark,fromVisitId:void 0!==this.$route.params.queue?parseInt(this.$route.params.queue):null};this.$axios.$post("/api/appoints",n,{progress:!1}).then((function(t){e.successSubmit(t,n.petId)})).catch((function(t){e.errorSubmit(t)}))}},successSubmit:function(e,t){var n=this;setTimeout((function(){n.loading=!1,n.alert=!1,n.appointDialog=!1,n.sendAppoint.cause="",n.sendAppoint.remark="",n.$refs.form.resetValidation(),n.$emit("updateAppoint",{appointDate:e.appointDate,petId:t})}),500)},errorSubmit:function(e){this.loading=!1,this.alert=!0,this.error=e.response.data.error.message}}},m=n(41),f=n(50),h=n.n(f),k=n(478),x=n(110),_=n(184),D=n(62),w=n(465),y=n(474),C=n(639),$=n(484),O=n(466),V=n(479),A=n(185),T=n(112),I=n(120),j=n(467),P=n(183),S=n(476),E=n(522),M=n(480),Y=n(483),N=n(528),R=n(485),F=n(461),z=n(525),B=n(649),component=Object(m.a)(v,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("v-dialog",{attrs:{"max-width":"800",scrollable:"",fullscreen:this.$vuetify.breakpoint.xsOnly},model:{value:e.appointDialog,callback:function(t){e.appointDialog=t},expression:"appointDialog"}},[n("v-card",[n("h2",{staticClass:"pa-5 pb-2"},[e._v("ทำนัด")]),e._v(" "),n("v-btn",{staticClass:"mt-4",attrs:{icon:"",absolute:"",right:""},on:{click:function(t){e.appointDialog=!1}}},[n("v-icon",[e._v("mdi-close")])],1),e._v(" "),n("v-divider",{staticClass:"darker-divider"}),e._v(" "),n("v-card-text",[n("v-form",{ref:"form",attrs:{"lazy-validation":"",autocomplete:"off"},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[n("v-row",{attrs:{align:"center",justify:"center"}},[n("v-col",{attrs:{cols:"12"}},[n("v-select",{attrs:{disabled:e.loading,items:e.doctor,"item-text":"name","item-value":"id",color:"cusblue","item-color":"cusblue",label:"แพทย์ผู้ตรวจ","menu-props":{closeOnContentClick:!0}},scopedSlots:e._u([{key:"prepend-item",fn:function(){return[n("v-list-item",{style:""===e.sendAppoint.doctor?"background-color: #e2f5fc":"",attrs:{ripple:""},on:{click:function(t){e.sendAppoint.doctor=""}}},[n("v-list-item-content",[n("v-list-item-title",{class:""===e.sendAppoint.doctor?"cusblue--text":""},[e._v("\n                        ไม่ระบุแพทย์\n                      ")])],1)],1),e._v(" "),n("v-divider",{staticClass:"mt-2"})]},proxy:!0}]),model:{value:e.sendAppoint.doctor,callback:function(t){e.$set(e.sendAppoint,"doctor",t)},expression:"sendAppoint.doctor"}})],1),e._v(" "),n("v-col",{attrs:{cols:"12",sm:"6"}},[n("v-menu",{ref:"menu",attrs:{"close-on-content-click":!1,transition:"scale-transition","offset-y":"","min-width":"290px"},scopedSlots:e._u([{key:"activator",fn:function(t){var o=t.on,r=t.attrs;return[n("v-text-field",e._g(e._b({ref:"bd",attrs:{disabled:e.loading,rules:e.rules.selectDate,label:"วันที่นัด",color:"cusblue","append-icon":"mdi-calendar-month",readonly:""},scopedSlots:e._u([{key:"append",fn:function(){return e._l(e.plusBtn,(function(t){return n("v-btn",{key:t.value,staticClass:"mb-1 ml-1",attrs:{color:"cusblue3 white--text",depressed:"",icon:"",small:"",outlined:""},on:{click:function(n){return e.plusDate(t.value)}}},[e._v("\n                        "+e._s(t.text)+"\n                      ")])}))},proxy:!0}],null,!0),model:{value:e.selectDate,callback:function(t){e.selectDate=t},expression:"selectDate"}},"v-text-field",r,!1),o))]}}]),model:{value:e.menuDate,callback:function(t){e.menuDate=t},expression:"menuDate"}},[e._v(" "),n("v-date-picker",{ref:"picker",attrs:{color:"cusblue",min:(new Date).toISOString().substr(0,10),value:"YYYY-mm",locale:"th","show-current":!1,scrollable:""},model:{value:e.sendAppoint.appointDate,callback:function(t){e.$set(e.sendAppoint,"appointDate",t)},expression:"sendAppoint.appointDate"}})],1)],1),e._v(" "),n("v-col",{attrs:{cols:"12",sm:"6"}},[n("v-menu",{ref:"menu",attrs:{"close-on-content-click":!1,transition:"scale-transition","offset-y":"","min-width":"290px"},scopedSlots:e._u([{key:"activator",fn:function(t){var o=t.on,r=t.attrs;return[n("v-text-field",e._g(e._b({attrs:{disabled:e.loading,rules:e.rules.appointTime,color:"cusblue","append-icon":"mdi-clock-outline","background-color":"white",label:"เวลา",readonly:""},model:{value:e.sendAppoint.appointTime,callback:function(t){e.$set(e.sendAppoint,"appointTime",t)},expression:"sendAppoint.appointTime"}},"v-text-field",r,!1),o))]}}]),model:{value:e.AppointTime,callback:function(t){e.AppointTime=t},expression:"AppointTime"}},[e._v(" "),n("v-time-picker",{ref:"picker",attrs:{color:"cusblue",format:"24hr",scrollable:""},model:{value:e.sendAppoint.appointTime,callback:function(t){e.$set(e.sendAppoint,"appointTime",t)},expression:"sendAppoint.appointTime"}})],1)],1),e._v(" "),n("v-col",{attrs:{cols:"12"}},[n("v-textarea",{attrs:{disabled:e.loading,rules:e.rules.cause,label:"สาเหตุการนัด",color:"cusblue","auto-grow":"","row-height":"24",rows:"1"},model:{value:e.sendAppoint.cause,callback:function(t){e.$set(e.sendAppoint,"cause",t)},expression:"sendAppoint.cause"}}),e._v(" "),e._l(e.appointType,(function(t){return n("v-chip",{key:t.id,staticClass:"mx-1",attrs:{small:""},on:{click:function(n){return e.addText(t.label)}}},[e._v("\n                "+e._s(t.label)+"\n              ")])}))],2),e._v(" "),n("v-col",{attrs:{cols:"12"}},[n("v-textarea",{attrs:{disabled:e.loading,rules:e.rules.remark,label:"หมายเหตุ",color:"cusblue","auto-grow":"","row-height":"24",rows:"1"},model:{value:e.sendAppoint.remark,callback:function(t){e.$set(e.sendAppoint,"remark",t)},expression:"sendAppoint.remark"}})],1)],1),e._v(" "),n("v-alert",{attrs:{dense:"",text:"",color:"red",transition:"scroll-y-transition",dismissible:""},model:{value:e.alert,callback:function(t){e.alert=t},expression:"alert"}},[e._v("\n            "+e._s(e.error)+"\n          ")])],1)],1),e._v(" "),n("v-card-actions",[n("v-spacer"),e._v(" "),n("v-btn",{staticClass:"cusblue2--text text-none",attrs:{disabled:e.loading,text:""},on:{click:function(t){e.appointDialog=!1}}},[e._v("\n          ยกเลิก\n        ")]),e._v(" "),n("v-btn",{staticClass:"cusblue2--text text-none",attrs:{disabled:!e.valid||e.loading,text:""},on:{click:e.submitAppoint}},[n("v-progress-circular",{directives:[{name:"show",rawName:"v-show",value:e.loading,expression:"loading"}],staticClass:"mr-2",attrs:{indeterminate:"",color:"cusblue2",size:15,width:2}}),e._v("\n          บันทึก\n        ")],1)],1)],1)],1),e._v(" "),n("v-dialog",{attrs:{"max-width":"500",scrollable:"",fullscreen:this.$vuetify.breakpoint.xsOnly},model:{value:e.oldAppointDialog,callback:function(t){e.oldAppointDialog=t},expression:"oldAppointDialog"}},[n("v-card",[n("h2",{staticClass:"pa-5 pb-2"},[e._v("นัดหมายเก่า")]),e._v(" "),n("v-btn",{staticClass:"mt-4",attrs:{icon:"",absolute:"",right:""},on:{click:function(t){e.oldAppointDialog=!1}}},[n("v-icon",[e._v("mdi-close")])],1),e._v(" "),n("v-divider",{staticClass:"darker-divider"}),e._v(" "),n("v-tabs",{staticClass:"pb-5",attrs:{"show-arrows":"",grow:"","hide-slider":"",color:"cusblue"}},[e._l(e.oldAppoint,(function(t){return n("v-tab",{key:t.id},[n("v-icon",{attrs:{left:""}},[e._v("mdi-calendar-month")]),e._v("\n          "+e._s(e.$moment(t.appointDate).format("DD/MM/YYYY"))+"\n        ")],1)})),e._v(" "),e._l(e.oldAppoint,(function(t){return n("v-tab-item",{key:t.id},[n("v-card",{attrs:{flat:""}},[n("v-card-text",[n("v-text-field",{attrs:{label:"เจ้าของ",value:t.pet.owner.name,disabled:""}}),e._v(" "),n("v-text-field",{attrs:{label:"แพทย์",value:null!==t.doctor?t.doctor.name:"ไม่ระบุแพทย์",disabled:""}}),e._v(" "),n("v-text-field",{attrs:{label:"สัตว์เลี้ยง",value:t.pet.name+"("+t.pet.type+")",disabled:""}}),e._v(" "),n("v-text-field",{attrs:{label:"นัดเพื่อ",value:t.cause,disabled:""}}),e._v(" "),n("v-text-field",{attrs:{label:"เวลา",value:t.appointTime,disabled:""}})],1)],1)],1)}))],2),e._v(" "),n("v-card-actions",[n("v-spacer"),e._v(" "),n("v-btn",{attrs:{color:"cusblue2",text:""},on:{click:function(t){e.oldAppointDialog=!1}}},[e._v("\n          ยกเลิก\n        ")]),e._v(" "),n("v-btn",{attrs:{color:"cusblue2",text:""},on:{click:e.showAddDialog}},[e._v(" เพิ่ม ")])],1)],1)],1)],1)}),[],!1,null,null,null);t.a=component.exports;h()(component,{VAlert:k.a,VBtn:x.a,VCard:_.a,VCardActions:D.a,VCardText:D.c,VChip:w.a,VCol:y.a,VDatePicker:C.a,VDialog:$.a,VDivider:O.a,VForm:V.a,VIcon:A.a,VListItem:T.a,VListItemContent:I.a,VListItemTitle:I.b,VMenu:j.a,VProgressCircular:P.a,VRow:S.a,VSelect:E.a,VSpacer:M.a,VTab:Y.a,VTabItem:N.a,VTabs:R.a,VTextField:F.a,VTextarea:z.a,VTimePicker:B.a})},567:function(e,t,n){"use strict";n(11),n(9),n(6),n(4),n(10);var o=n(1);n(51);function r(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}var l={data:function(){return{sendCheckDialog:!1,doctor:this.$store.state.form.doctor,priority:this.$store.state.form.priority,loading:!1,alert:!1,error:"",sendCheck:{petId:"",type:"",time:"",status:"",doctor:"",important:1,weight:"",temp:"",do:{check:[],other:{text:"",enabled:!1}},problem:"",appointId:""},valid:!0,rules:{important:[function(e){return!!e||"กรุณาเลือกความสำคัญ"}],weight:[function(e){return!!e||"กรุณากรอกน้ำหนัก"},function(e){return/^[0-9]*\.?[0-9]{1,2}$/.test(e)||"กรุณากรอกตัวเลขเท่านั้น"},function(e){return e&&e.split(".")[0].length<=3||"ไม่ควรกรอกน้ำหนักเกิน 3 หลัก"}],temp:[function(e){return/^[0-9]*\.?[0-9]{1,2}$/.test(e)||"กรุณากรอกตัวเลขเท่านั้น"},function(e){return!e||e.split(".")[0].length<=3||"ไม่ควรกรอกอุณหภูมิเกิน 3 หลัก"}]}}},watch:{sendCheckDialog:function(){!1===this.sendCheckDialog&&this.$refs.form.reset()}},mounted:function(){var e=this;0===this.$store.state.form.doctor.length&&this.$store.dispatch("form/addDoctor").then((function(t){e.doctor=t})),0===this.$store.state.form.priority.length&&this.$store.dispatch("form/addPriority").then((function(t){e.priority=t}))},methods:{open:function(e,t){this.sendCheck.petId=e,this.sendCheckDialog=!0,this.sendCheck.doctor=this.$store.getters.loggedInUser.roles.some((function(e){return 2===e.id}))?this.$store.getters.loggedInUser.id:""},open1:function(e,t,n){this.sendCheck.petId=e,this.sendCheck.doctor=null!==t?t:"",this.sendCheck.appointId=n,this.sendCheckDialog=!0},submitCheck:function(){var e=this;if(this.$refs.form.validate()){this.loading=!0;var t=function(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?r(Object(source),!0).forEach((function(t){Object(o.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):r(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}({},this.sendCheck);t.do.other.enabled&&""!==t.do.other.text&&t.do.check.push(t.do.other.text);var n={petId:t.petId,doctorId:""===t.doctor?null:t.doctor,visitPriorityId:t.important,weight:t.weight,temp:""===t.temp?null:t.temp,visitCause:t.do.check.join(", "),note:t.problem,appointId:""===t.appointId?null:t.appointId};this.$axios.$post("/api/visits",n,{progress:!1}).then((function(n){setTimeout((function(){e.loading=!1,e.alert=!1,e.sendCheckDialog=!1,""!==t.appointId&&e.$emit("updateAppoint",{appointId:t.appointId,respone:n})}),500)})).catch((function(t){e.loading=!1,e.alert=!0,e.error=t.response.data.error.message}))}}}},c=n(41),d=n(50),v=n.n(d),m=n(478),f=n(110),h=n(184),k=n(62),x=n(487),_=n(474),D=n(484),w=n(466),y=n(479),C=n(185),$=n(112),O=n(120),V=n(183),A=n(476),T=n(522),I=n(480),j=n(461),P=n(525),component=Object(c.a)(l,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("v-dialog",{attrs:{"max-width":"700",scrollable:"",fullscreen:this.$vuetify.breakpoint.xsOnly},model:{value:e.sendCheckDialog,callback:function(t){e.sendCheckDialog=t},expression:"sendCheckDialog"}},[n("v-card",[n("h2",{staticClass:"pa-5 pb-2"},[e._v("ส่งตรวจ")]),e._v(" "),n("v-btn",{staticClass:"mt-4",attrs:{icon:"",absolute:"",right:""},on:{click:function(t){e.sendCheckDialog=!1}}},[n("v-icon",[e._v("mdi-close")])],1),e._v(" "),n("v-divider",{staticClass:"darker-divider"}),e._v(" "),n("v-card-text",[n("v-form",{ref:"form",attrs:{"lazy-validation":"",autocomplete:"off"},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[n("v-row",{attrs:{dense:""}},[n("v-col",{attrs:{cols:"6"}},[n("v-select",{attrs:{disabled:e.loading,items:e.doctor,"item-text":"name","item-value":"id",color:"cusblue","item-color":"cusblue",label:"แพทย์ผู้ตรวจ","menu-props":{closeOnContentClick:!0}},scopedSlots:e._u([{key:"prepend-item",fn:function(){return[n("v-list-item",{style:""===e.sendCheck.doctor?"background-color: #e2f5fc":"",attrs:{ripple:""},on:{click:function(t){e.sendCheck.doctor=""}}},[n("v-list-item-content",[n("v-list-item-title",{class:""===e.sendCheck.doctor?"cusblue--text":""},[e._v("\n                        ไม่ระบุแพทย์\n                      ")])],1)],1),e._v(" "),n("v-divider",{staticClass:"mt-2"})]},proxy:!0}]),model:{value:e.sendCheck.doctor,callback:function(t){e.$set(e.sendCheck,"doctor",t)},expression:"sendCheck.doctor"}})],1),e._v(" "),n("v-col",{attrs:{cols:"6"}},[n("v-select",{attrs:{disabled:e.loading,items:e.priority,"item-text":"label","item-value":"id",color:"cusblue",label:"ความสำคัญ",rules:e.rules.important},model:{value:e.sendCheck.important,callback:function(t){e.$set(e.sendCheck,"important",t)},expression:"sendCheck.important"}})],1),e._v(" "),n("v-col",{attrs:{cols:"6"}},[n("v-text-field",{attrs:{disabled:e.loading,color:"cusblue",label:"นำหนัก / kg",rules:e.rules.weight},model:{value:e.sendCheck.weight,callback:function(t){e.$set(e.sendCheck,"weight",t)},expression:"sendCheck.weight"}})],1),e._v(" "),n("v-col",{attrs:{cols:"6"}},[n("v-text-field",{attrs:{disabled:e.loading,color:"cusblue",label:"อุณหภูมิ / F°",rules:e.rules.temp},model:{value:e.sendCheck.temp,callback:function(t){e.$set(e.sendCheck,"temp",t)},expression:"sendCheck.temp"}})],1),e._v(" "),n("v-col",{attrs:{cols:"6",sm:"4"}},[n("v-checkbox",{staticClass:"mx-2",attrs:{disabled:e.loading,value:"ดูอาการ",label:"ดูอาการ"},model:{value:e.sendCheck.do.check,callback:function(t){e.$set(e.sendCheck.do,"check",t)},expression:"sendCheck.do.check"}})],1),e._v(" "),n("v-col",{attrs:{cols:"6",sm:"4"}},[n("v-checkbox",{staticClass:"mx-2",attrs:{disabled:e.loading,value:"ทำแผล",label:"ทำแผล"},model:{value:e.sendCheck.do.check,callback:function(t){e.$set(e.sendCheck.do,"check",t)},expression:"sendCheck.do.check"}})],1),e._v(" "),n("v-col",{attrs:{cols:"6",sm:"4"}},[n("v-checkbox",{staticClass:"mx-2",attrs:{disabled:e.loading,value:"ฟังผลตรวจ",label:"ฟังผลตรวจ Lab"},model:{value:e.sendCheck.do.check,callback:function(t){e.$set(e.sendCheck.do,"check",t)},expression:"sendCheck.do.check"}})],1),e._v(" "),n("v-col",{attrs:{cols:"6",sm:"4"}},[n("v-checkbox",{staticClass:"mx-2",attrs:{disabled:e.loading,value:"ฉีดยา",label:"ฉีดยา"},model:{value:e.sendCheck.do.check,callback:function(t){e.$set(e.sendCheck.do,"check",t)},expression:"sendCheck.do.check"}})],1),e._v(" "),n("v-col",{attrs:{cols:"6",sm:"4"}},[n("v-checkbox",{staticClass:"mx-2",attrs:{disabled:e.loading,value:"ให้น้ำเกลือ",label:"ให้น้ำเกลือ"},model:{value:e.sendCheck.do.check,callback:function(t){e.$set(e.sendCheck.do,"check",t)},expression:"sendCheck.do.check"}})],1),e._v(" "),n("v-col",{attrs:{cols:"6",sm:"4"}},[n("v-checkbox",{staticClass:"mx-2",attrs:{disabled:e.loading,value:"Xray / Ultrasound",label:"Xray / Ultrasound"},model:{value:e.sendCheck.do.check,callback:function(t){e.$set(e.sendCheck.do,"check",t)},expression:"sendCheck.do.check"}})],1),e._v(" "),n("v-col",{staticClass:"px-3",attrs:{cols:"12"}},[n("v-row",{attrs:{align:"center","no-gutters":""}},[n("v-checkbox",{staticClass:"shrink mr-2 mt-0",attrs:{disabled:e.loading,"hide-details":"",label:"อื่นๆ"},model:{value:e.sendCheck.do.other.enabled,callback:function(t){e.$set(e.sendCheck.do.other,"enabled",t)},expression:"sendCheck.do.other.enabled"}}),e._v(" "),n("v-text-field",{staticClass:"mt-5",attrs:{color:"cusblue",dense:"",disabled:!e.sendCheck.do.other.enabled||e.loading},model:{value:e.sendCheck.do.other.text,callback:function(t){e.$set(e.sendCheck.do.other,"text",t)},expression:"sendCheck.do.other.text"}})],1)],1),e._v(" "),n("v-col",{attrs:{cols:"12"}},[n("v-textarea",{attrs:{disabled:e.loading,color:"cusblue",label:"Note","auto-grow":"","row-height":"24",rows:"1"},model:{value:e.sendCheck.problem,callback:function(t){e.$set(e.sendCheck,"problem",t)},expression:"sendCheck.problem"}})],1)],1),e._v(" "),n("v-alert",{attrs:{dense:"",text:"",color:"red",transition:"scroll-y-transition",dismissible:""},model:{value:e.alert,callback:function(t){e.alert=t},expression:"alert"}},[e._v("\n            "+e._s(e.error)+"\n          ")])],1)],1),e._v(" "),n("v-card-actions",[n("v-spacer"),e._v(" "),n("v-btn",{attrs:{color:"cusblue2",disabled:e.loading,text:""},on:{click:function(t){e.sendCheckDialog=!1}}},[e._v("\n          ไม่ส่ง\n        ")]),e._v(" "),n("v-btn",{attrs:{color:"cusblue2",disabled:!e.valid||e.loading,text:""},on:{click:e.submitCheck}},[n("v-progress-circular",{directives:[{name:"show",rawName:"v-show",value:e.loading,expression:"loading"}],staticClass:"mr-2",attrs:{indeterminate:"",color:"cusblue2",size:15,width:2}}),e._v("\n          ส่ง\n        ")],1)],1)],1)],1)],1)}),[],!1,null,null,null);t.a=component.exports;v()(component,{VAlert:m.a,VBtn:f.a,VCard:h.a,VCardActions:k.a,VCardText:k.c,VCheckbox:x.a,VCol:_.a,VDialog:D.a,VDivider:w.a,VForm:y.a,VIcon:C.a,VListItem:$.a,VListItemContent:O.a,VListItemTitle:O.b,VProgressCircular:V.a,VRow:A.a,VSelect:T.a,VSpacer:I.a,VTextField:j.a,VTextarea:P.a})},628:function(e,t,n){"use strict";n.r(t);n(122),n(6),n(4),n(42);var o=n(7),r={props:{title:{type:String,required:!0}}},l=n(41),c=n(50),d=n.n(c),v=n(474),m=n(476),component=Object(l.a)(r,(function(){var e=this.$createElement,t=this._self._c||e;return t("v-row",{staticClass:"cusblue1 second-nav1",attrs:{align:"center",justify:"center",dense:""}},[t("v-col",{attrs:{md:"12",cols:"12"}},[t("h1",{staticClass:"font-weight-medium"},[this._v(this._s(this.title))])])],1)}),[],!1,null,null,null),f=component.exports;d()(component,{VCol:v.a,VRow:m.a});var h=n(564),k=n(488),x=n(202),_={components:{recordDialog:h.a,confirmDialog:k.a,userAvatar:x.a},props:{owner:{default:null,type:Object,required:!1}},data:function(){return{avatar:"".concat("https://api.vet-clinic.somprasongd.work","/api/members/").concat(this.owner.id,"/avatar"),actionBtns:[{text:"แก้ไขข้อมูล",action:this.updateMember},{text:"ลบข้อมูล",action:this.deleteMember}]}},methods:{dashPhone:function(e){return e.slice(0,3)+"-"+e.slice(3,6)+"-"+e.slice(6,11)},updateMember:function(){this.$refs.updateMemberDialog.open(this.owner)},sendMemberData:function(e){this.$emit("update",e)},deleteMember:function(){var e=this;this.$refs.confirm.open("คุณแน่ใจหรือไม่?","คุณแน่ใจหรือไม่ที่จะลบข้อมูลนี้",{width:290,color:"red"}).then((function(t){e.$axios.$delete("/api/members/".concat(e.$route.params.owner),{progress:!1}).then((function(t){e.$router.push("/record")})).catch((function(e){alert(e)}))})).catch((function(){}))}}},D=n(110),w=n(184),y=n(62),C=n(466),$=n(185),O=n(187),V=n(112),A=n(467),T=Object(l.a)(_,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("v-card",{staticClass:"elevation-5"},[n("v-card-title",[e._v("ข้อมูลเจ้าของสัตว์")]),e._v(" "),n("v-divider",{staticClass:"darker-divider"}),e._v(" "),n("div",{staticClass:"px-10 py-5"},[n("v-row",{attrs:{"no-gutters":""}},[n("v-col",{attrs:{lg:"1",md:"2",sm:"3",cols:"4"}},[n("v-row",{attrs:{"no-gutters":""}},[n("v-col",{attrs:{cols:"12"}},[n("userAvatar",{attrs:{avatarid:e.owner.id.toString(),avatars:e.avatar,"type-avatar":"members",size:100,"delete-img":!1}})],1),e._v(" "),n("v-col",{attrs:{cols:"12"}},[n("v-menu",{attrs:{"offset-y":"","nudge-left":"80"},scopedSlots:e._u([{key:"activator",fn:function(t){var o=t.on,r=t.attrs;return[n("v-btn",e._g(e._b({staticClass:"mx-7",attrs:{color:"cusblue2",dark:"",icon:"",depressed:"",large:""}},"v-btn",r,!1),o),[n("v-icon",[e._v("mdi-dots-horizontal-circle")])],1)]}}])},[e._v(" "),n("v-list",{attrs:{width:"200"}},[n("v-list-item",[n("h4",[e._v("Action")])]),e._v(" "),n("v-divider"),e._v(" "),e._l(e.actionBtns,(function(t){return n("v-btn",{key:t.text,staticClass:"cusblue2--text",attrs:{block:"",text:"",tile:""},on:{click:t.action}},[e._v(e._s(t.text))])}))],2)],1)],1)],1)],1),e._v(" "),n("v-col",{staticClass:"pa-6",attrs:{lg:"11",md:"10",sm:"9",cols:"8"}},[n("v-row",{attrs:{"no-gutters":""}},[n("v-col",{attrs:{cols:"12"}},[n("div",{staticClass:"font-weight-medium"},[e._v("\n                "+e._s(e.owner.firstName+" "+e.owner.lastName)+"\n              ")])]),e._v(" "),n("v-col",{attrs:{lg:"3",md:"6",cols:"12"}},[n("span",{staticClass:"font-weight-medium"},[e._v("เบอร์ติดต่อ :")]),e._v(" "),e._l(e.owner.tels,(function(t){return n("span",{key:t,staticClass:"font-weight-light"},[e._v("\n                "+e._s(e.dashPhone(t)+", ")+"\n              ")])}))],2),e._v(" "),n("v-col",{attrs:{lg:"4",md:"6",cols:"12"}},[n("span",{staticClass:"font-weight-medium"},[e._v("Email :")]),e._v(" "),n("span",{staticClass:"font-weight-light"},[e._v(e._s(e.owner.email))])]),e._v(" "),n("v-col",{attrs:{lg:"5",md:"12",cols:"12"}},[n("span",{staticClass:"font-weight-medium"},[e._v("ที่อยู่ :")]),e._v(" "),n("span",{staticClass:"font-weight-light"},[e._v("\n                "+e._s(e.owner.houseNo)+" "+e._s(e.owner.address)+"\n              ")])])],1)],1)],1)],1)],1),e._v(" "),n("recordDialog",{ref:"updateMemberDialog",on:{update:e.sendMemberData}}),e._v(" "),n("confirmDialog",{ref:"confirm"})],1)}),[],!1,null,null,null),I=T.exports;d()(T,{VBtn:D.a,VCard:w.a,VCardTitle:y.d,VCol:v.a,VDivider:C.a,VIcon:$.a,VList:O.a,VListItem:V.a,VMenu:A.a,VRow:m.a});n(19),n(20);var j=n(567),P=(n(11),n(9),n(10),n(1)),S=n(86),E=n.n(S);function M(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}var Y={data:function(){return{petId:"",depositDialog:!1,valid:!1,loading:!1,alert:!1,error:"",menuDate:!1,DepositDate:!1,DepositTime:!1,sendDeposit:{petId:"",DepositDate:"",DepositTime:"",note:""},rules:{DepositDate:[function(e){return!!e||"กรุณาเลือกวันที่นัด"}],DepositTime:[function(e){return!!e||"กรุณาเลือกเวลานัด"}],note:[function(e){return e.length<=1e3||"ไม่ควรกรอกสาเหตุการนัด 1000 ตัวอักษร"}]}}},computed:{selectDate:function(){return this.sendDeposit.DepositDate?E()(this.sendDeposit.DepositDate).format("DD/MM/YYYY"):null}},methods:{open:function(e){this.sendDeposit.petId=e,this.depositDialog=!0,this.sendDeposit.DepositDate=(new Date).toISOString().substr(0,10),this.sendDeposit.DepositTime=E()().format("HH:mm:ss")},plusDate:function(e){this.sendDeposit.DepositDate=E()(this.sendDeposit.DepositDate).add(e,"days").format("YYYY-MM-DD")},submitDeposit:function(){var e=this;if(this.$refs.form.validate()){var t=function(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?M(Object(source),!0).forEach((function(t){Object(P.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):M(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}({},this.sendDeposit),n=E()(t.DepositDate+" "+t.DepositTime,"YYYY-MM-DD HH:mm:ss"),o={petId:t.petId,visitAt:n.toISOString(),note:t.note};this.$axios.$post("/api/visits/daycare",o,{progress:!1}).then((function(t){e.successSubmit(t)})).catch((function(t){e.errorSubmit(t)}))}},successSubmit:function(e){var t=this;setTimeout((function(){t.loading=!1,t.alert=!1,t.depositDialog=!1,t.sendDeposit.note="",t.$refs.form.resetValidation()}),500)},errorSubmit:function(e){this.loading=!1,this.alert=!0,this.error=e.response.data.error.message}}},N=n(478),R=n(639),F=n(484),z=n(479),B=n(183),L=n(480),G=n(461),H=n(525),U=n(649),W=Object(l.a)(Y,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-dialog",{attrs:{"max-width":"800",scrollable:"",fullscreen:this.$vuetify.breakpoint.xsOnly},model:{value:e.depositDialog,callback:function(t){e.depositDialog=t},expression:"depositDialog"}},[n("v-card",[n("h2",{staticClass:"pa-5 pb-2"},[e._v("ฝากเลี้ยง")]),e._v(" "),n("v-btn",{staticClass:"mt-4",attrs:{icon:"",absolute:"",right:""},on:{click:function(t){e.depositDialog=!1}}},[n("v-icon",[e._v("mdi-close")])],1),e._v(" "),n("v-divider",{staticClass:"darker-divider"}),e._v(" "),n("v-card-text",{staticClass:"px-7"},[n("v-form",{ref:"form",attrs:{"lazy-validation":"",autocomplete:"off"},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[n("v-row",{attrs:{align:"center",justify:"center"}},[n("v-col",{attrs:{cols:"12",sm:"6"}},[n("v-menu",{ref:"menu",attrs:{"close-on-content-click":!1,transition:"scale-transition","offset-y":"","min-width":"290px"},scopedSlots:e._u([{key:"activator",fn:function(t){var o=t.on,r=t.attrs;return[n("v-text-field",e._g(e._b({ref:"bd",attrs:{disabled:e.loading,rules:e.rules.selectDate,label:"วันเกิด",color:"cusblue","append-icon":"mdi-calendar-month",readonly:""},model:{value:e.selectDate,callback:function(t){e.selectDate=t},expression:"selectDate"}},"v-text-field",r,!1),o))]}}]),model:{value:e.menuDate,callback:function(t){e.menuDate=t},expression:"menuDate"}},[e._v(" "),n("v-date-picker",{ref:"picker",attrs:{color:"cusblue",min:(new Date).toISOString().substr(0,10),value:"YYYY-mm",locale:"th","show-current":!1,scrollable:""},model:{value:e.sendDeposit.DepositDate,callback:function(t){e.$set(e.sendDeposit,"DepositDate",t)},expression:"sendDeposit.DepositDate"}})],1)],1),e._v(" "),n("v-col",{attrs:{cols:"12",sm:"6"}},[n("v-menu",{ref:"menu",attrs:{"close-on-content-click":!1,transition:"scale-transition","offset-y":"","min-width":"290px"},scopedSlots:e._u([{key:"activator",fn:function(t){var o=t.on,r=t.attrs;return[n("v-text-field",e._g(e._b({attrs:{disabled:e.loading,rules:e.rules.DepositTime,color:"cusblue","append-icon":"mdi-clock-outline","background-color":"white",label:"เวลา",readonly:""},model:{value:e.sendDeposit.DepositTime,callback:function(t){e.$set(e.sendDeposit,"DepositTime",t)},expression:"sendDeposit.DepositTime"}},"v-text-field",r,!1),o))]}}]),model:{value:e.DepositTime,callback:function(t){e.DepositTime=t},expression:"DepositTime"}},[e._v(" "),n("v-time-picker",{ref:"picker",attrs:{color:"cusblue",format:"24hr","use-seconds":"",scrollable:""},model:{value:e.sendDeposit.DepositTime,callback:function(t){e.$set(e.sendDeposit,"DepositTime",t)},expression:"sendDeposit.DepositTime"}})],1)],1),e._v(" "),n("v-col",{attrs:{cols:"12"}},[n("v-textarea",{attrs:{disabled:e.loading,rules:e.rules.note,label:"Note",color:"cusblue","auto-grow":"","row-height":"24",rows:"1"},model:{value:e.sendDeposit.note,callback:function(t){e.$set(e.sendDeposit,"note",t)},expression:"sendDeposit.note"}})],1)],1),e._v(" "),n("v-alert",{attrs:{dense:"",text:"",color:"red",transition:"scroll-y-transition",dismissible:""},model:{value:e.alert,callback:function(t){e.alert=t},expression:"alert"}},[e._v("\n          "+e._s(e.error)+"\n        ")])],1)],1),e._v(" "),n("v-card-actions",[n("v-spacer"),e._v(" "),n("v-btn",{staticClass:"cusblue2--text text-none",attrs:{disabled:e.loading,text:""}},[e._v("\n        ยกเลิก\n      ")]),e._v(" "),n("v-btn",{staticClass:"cusblue2--text text-none",attrs:{disabled:!e.valid||e.loading,text:""},on:{click:e.submitDeposit}},[n("v-progress-circular",{directives:[{name:"show",rawName:"v-show",value:e.loading,expression:"loading"}],staticClass:"mr-2",attrs:{indeterminate:"",color:"cusblue2",size:15,width:2}}),e._v("\n        บันทึก\n      ")],1)],1)],1)],1)}),[],!1,null,null,null),J=W.exports;d()(W,{VAlert:N.a,VBtn:D.a,VCard:w.a,VCardActions:y.a,VCardText:y.c,VCol:v.a,VDatePicker:R.a,VDialog:F.a,VDivider:C.a,VForm:z.a,VIcon:$.a,VMenu:A.a,VProgressCircular:B.a,VRow:m.a,VSpacer:L.a,VTextField:G.a,VTextarea:H.a,VTimePicker:U.a});var X=n(566),K={data:function(){return{sendOwner:!1,petId:"",search:null,owner:"",member:[],loading:!1,loading1:!1,timeout:null}},watch:{search:function(e){var t=this;clearTimeout(this.timeout),this.timeout=setTimeout((function(){null!==e&&""!==e&&t.querySelections(e)}),500)}},methods:{open:function(e){this.owner="",this.petId=e,this.sendOwner=!0},getOwnerAvatar:function(e){return"".concat("https://api.vet-clinic.somprasongd.work","/api/members/").concat(e,"/avatar")},querySelections:function(e){var t=this;this.loading1=!0,this.$axios.$get("/api/members?firstName=".concat(e),{progress:!1}).then((function(e){t.member=e.results,t.loading1=!1})).catch((function(e){alert(e)}))},submitSend:function(){var e=this;this.loading=!0,this.$axios.$patch("/api/pets/".concat(this.petId,"/owner/").concat(this.owner),null,{progress:!1}).then((function(t){setTimeout((function(){e.sendOwner=!1,e.loading=!1,e.$emit("removePet",e.petId)}),500)})).catch((function(t){e.loading=!1,alert(t)}))}}},Q=n(539),Z=n(186),ee=n(465),te=n(266),ne=n(189),ae=n(120),oe=Object(l.a)(K,(function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("v-dialog",{attrs:{"max-width":"450",scrollable:"",fullscreen:this.$vuetify.breakpoint.xsOnly,transition:"dialog-transition"},model:{value:e.sendOwner,callback:function(t){e.sendOwner=t},expression:"sendOwner"}},[o("v-card",[o("h2",{staticClass:"pa-5 pb-2"},[e._v("เปลี่ยนเจ้าของ")]),e._v(" "),o("v-divider"),e._v(" "),o("v-card-text",{staticClass:"py-3 px-7"},[o("v-autocomplete",{attrs:{items:e.member,"search-input":e.search,loading:e.loading1,chips:"","hide-no-data":"",dense:"",color:"cusblue",label:"เจ้าของใหม่","item-text":"fullName","item-value":"id"},on:{"update:searchInput":function(t){e.search=t},"update:search-input":function(t){e.search=t}},scopedSlots:e._u([{key:"selection",fn:function(data){return[o("v-chip",e._b({attrs:{"input-value":data.selected},on:{click:data.select}},"v-chip",data.attrs,!1),[o("v-avatar",{attrs:{left:""}},[o("v-img",{attrs:{src:e.getOwnerAvatar(data.item.id),"lazy-src":n(128)}})],1),e._v("\n            "+e._s(data.item.fullName)+"\n          ")],1)]}},{key:"item",fn:function(data){return[[o("v-list-item-avatar",[o("v-img",{attrs:{src:e.getOwnerAvatar(data.item.id),"lazy-src":n(128)}})],1),e._v(" "),o("v-list-item-content",[o("v-list-item-title",[e._v(e._s(data.item.fullName))])],1)]]}}]),model:{value:e.owner,callback:function(t){e.owner=t},expression:"owner"}})],1),e._v(" "),o("v-card-actions",[o("v-spacer"),e._v(" "),o("v-btn",{attrs:{color:"cusblue2",disabled:e.loading,text:""},on:{click:function(t){e.sendOwner=!1}}},[e._v("\n        ยกเลิก\n      ")]),e._v(" "),o("v-btn",{attrs:{color:"cusblue2",disabled:e.loading,text:""},on:{click:e.submitSend}},[o("v-progress-circular",{directives:[{name:"show",rawName:"v-show",value:e.loading,expression:"loading"}],staticClass:"mr-2",attrs:{indeterminate:"",color:"cusblue2",size:15,width:2}}),e._v("\n        ยืนยัน\n      ")],1)],1)],1)],1)}),[],!1,null,null,null),se=oe.exports;d()(oe,{VAutocomplete:Q.a,VAvatar:Z.a,VBtn:D.a,VCard:w.a,VCardActions:y.a,VCardText:y.c,VChip:ee.a,VDialog:F.a,VDivider:C.a,VImg:te.a,VListItemAvatar:ne.a,VListItemContent:ae.a,VListItemTitle:ae.b,VProgressCircular:B.a,VSpacer:L.a});var re={components:{sendcheckDialog:j.a,depositDialog:J,appointDialog:X.a,sendOwnerDialog:se,confirmDialog:k.a,userAvatar:x.a},props:{pets:{default:null,type:Array,required:!1}},data:function(){return{}},methods:{getPetAvatar:function(e){return"".concat("https://api.vet-clinic.somprasongd.work","/api/pets/").concat(e,"/avatar")},onClickApp:function(e){this.$refs.appDialog.open(e)},changeOwner:function(e){this.$refs.sendOwnerDialog.open(e)},calcAge:function(e){var t=E()(),n=E()(e.toString(),"YYYY-MM-DD"),o=E.a.duration(t.diff(n));return o.years()+" ปี "+o.months()+" เดือน "+o.days()+" วัน "},updateOwner:function(e){this.$emit("del",e)},onClickCheck:function(e){var t=this;return Object(o.a)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.$axios.$get("/api/visits//is-visit/".concat(e),{progress:!1});case 2:n.sent.status?t.$refs.confirm.open("ต้องการส่งอีกครั้งหรือไม่?","สัตว์เลี้ยงตัวนี้ได้ถูกฝากเลี้ยงแล้วคุณต้องการส่งอีกครั้งหรือไม่",{width:350,color:"red"}).then((function(n){t.$refs.checkDialog.open(e)})).catch((function(){})):t.$refs.checkDialog.open(e);case 4:case"end":return n.stop()}}),n)})))()},onClickDepo:function(e){var t=this;return Object(o.a)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.$axios.$get("/api/visits/is-daycare/".concat(e),{progress:!1});case 2:n.sent.status?t.$refs.confirm.open("ต้องการส่งอีกครั้งหรือไม่?","สัตว์เลี้ยงตัวนี้ได้ถูกส่งตรวจแล้วคุณต้องการส่งอีกครั้งหรือไม่",{width:350,color:"red"}).then((function(n){t.$refs.depoDialog.open(e)})).catch((function(){})):t.$refs.depoDialog.open(e);case 4:case"end":return n.stop()}}),n)})))()},deletePet:function(e){var t=this;this.$refs.confirm.open("คุณแน่ใจหรือไม่?","คุณแน่ใจหรือไม่ที่จะลบข้อมูลนี้",{width:290,color:"red"}).then((function(n){t.$axios.$delete("/api/pets/".concat(e),{progress:!1}).then((function(n){t.$emit("del",e)})).catch((function(e){alert(e)}))})).catch((function(){}))},petDead:function(e,t){var n=this;this.$refs.confirm.open("คุณแน่ใจหรือไม่?","คุณแน่ใจหรือไม่ที่จะ".concat(t?"แจ้งตาย":"ยกเลิกแจ้งตาย"),{width:290,color:"red"}).then((function(o){n.$axios.$patch("/api/pets/".concat(e),{death:t},{progress:!1}).then((function(o){var r=n.pets.findIndex((function(t){return t.id===e}));n.pets[r].death=t})).catch((function(e){alert(e)}))})).catch((function(){}))},updateAppoint:function(e){var t=this.pets.findIndex((function(t){return t.id===e.petId}));(""===this.pets[t].nextAppoint||E()(e.appointDate)<E()(this.pets[t].nextAppoint))&&(this.pets[t].nextAppoint=e.appointDate)}}},ie=Object(l.a)(re,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("v-card",{staticClass:"elevation-5"},[n("v-card-title",[e._v("ข้อมูลสัตว์เลี้ยง")]),e._v(" "),n("v-divider",{staticClass:"darker-divider"}),e._v(" "),""!=e.pets?n("div",[e._l(e.pets,(function(t,i){return n("div",{key:i},[n("v-row",{staticClass:"px-10 py-5",attrs:{"no-gutters":""}},[n("v-col",{attrs:{lg:"1",md:"2",cols:"6"}},[n("v-row",[n("v-col",{staticClass:"text-center",attrs:{cols:"12"}},[n("userAvatar",{attrs:{avatarid:t.id.toString(),avatars:e.getPetAvatar(t.id),"type-avatar":"pets",size:100,"delete-img":!1,"border-color":t.death?"#E64A19":"#1E88E5","upload-img":!t.death}})],1),e._v(" "),n("v-col",{staticClass:"text-center",attrs:{cols:"12"}},[n("v-menu",{attrs:{"offset-y":"","nudge-left":"80"},scopedSlots:e._u([{key:"activator",fn:function(t){var o=t.on,r=t.attrs;return[n("v-btn",e._g(e._b({staticClass:"mx-7",attrs:{color:"cusblue2",dark:"",icon:"",depressed:"",large:""}},"v-btn",r,!1),o),[n("v-icon",[e._v("mdi-dots-horizontal-circle")])],1)]}}],null,!0)},[e._v(" "),n("v-list",{attrs:{width:"200"}},[n("v-list-item",[n("h4",[e._v("Action")])]),e._v(" "),n("v-divider"),e._v(" "),n("v-btn",{staticClass:"cusblue2--text",attrs:{disabled:t.death,block:"",text:"",tile:""},on:{click:function(n){return e.$emit("update",t)}}},[e._v("\n                      แก้ไขข้อมูล\n                    ")]),e._v(" "),n("v-btn",{staticClass:"cusblue2--text",attrs:{block:"",text:"",tile:""},on:{click:function(n){return e.petDead(t.id,!t.death)}}},[e._v("\n                      "+e._s(t.death?"ยกเลิกแจ้งตาย":"แจ้งตาย")+"\n                    ")]),e._v(" "),n("v-btn",{staticClass:"cusblue2--text",attrs:{disabled:t.death,block:"",text:"",tile:""},on:{click:function(n){return e.changeOwner(t.id)}}},[e._v("\n                      เปลี่ยนเจ้าของ\n                    ")]),e._v(" "),n("v-btn",{staticClass:"cusblue2--text",attrs:{block:"",text:"",tile:""},on:{click:function(n){return e.deletePet(t.id)}}},[e._v("\n                      ลบข้อมูล\n                    ")])],1)],1)],1)],1)],1),e._v(" "),n("v-col",{staticClass:"pa-4 pt-6",attrs:{lg:"10",md:"8",cols:"12",order:e.$vuetify.breakpoint.smAndDown?"last":""}},[n("v-row",{attrs:{dense:""}},[n("v-col",{staticClass:"order-first",attrs:{lg:"4",sm:"6",cols:"6"}},[n("span",{staticClass:"font-weight-medium"},[e._v("ชื่อสัตว์เลี้ยง :")]),e._v(" "),n("span",{staticClass:"font-weight-light"},[e._v(e._s(t.name))])]),e._v(" "),n("v-col",{class:(e.$vuetify.breakpoint.smAndDown,"order-2"),attrs:{lg:"4",sm:"6",cols:"6"}},[n("span",{staticClass:"font-weight-medium"},[e._v("อายุ :")]),e._v(" "),n("span",{staticClass:"font-weight-light"},[e._v(e._s(e.calcAge(t.birthDate)))])]),e._v(" "),n("v-col",{class:e.$vuetify.breakpoint.smAndDown?"order-4":"order-3",attrs:{lg:"4",sm:"6",cols:"6"}},[n("span",{staticClass:"font-weight-medium"},[e._v("วันเกิด :")]),e._v(" "),n("span",{staticClass:"font-weight-light"},[e._v(e._s(e.$moment(t.birthDate).format("DD/MM/YYYY")))])]),e._v(" "),n("v-col",{class:e.$vuetify.breakpoint.smAndDown?"order-3":"order-4",attrs:{lg:"4",sm:"6",cols:"6"}},[n("span",{staticClass:"font-weight-medium"},[e._v("ประเภท :")]),e._v(" "),n("span",{staticClass:"font-weight-light"},[e._v(e._s(t.type.label))])]),e._v(" "),n("v-col",{class:e.$vuetify.breakpoint.smAndDown?"order-5":"order-7",attrs:{lg:"4",sm:"6",cols:"6"}},[n("span",{staticClass:"font-weight-medium"},[e._v("สายพันธุ์ :")]),e._v(" "),n("span",{staticClass:"font-weight-light"},[e._v(e._s(t.breed))])]),e._v(" "),n("v-col",{class:e.$vuetify.breakpoint.smAndDown?"order-7":"order-10",attrs:{lg:"4",sm:"6",cols:"6"}},[n("span",{staticClass:"font-weight-medium"},[e._v("เพศ :")]),e._v(" "),n("span",{staticClass:"font-weight-light"},[e._v(e._s(t.gender.label))])]),e._v(" "),n("v-col",{class:e.$vuetify.breakpoint.smAndDown?"order-11":"order-5",attrs:{lg:"4",sm:"6",cols:"6"}},[n("span",{staticClass:"font-weight-medium"},[e._v("ทำหมัน :")]),e._v(" "),n("span",{staticClass:"font-weight-light"},[e._v(e._s(t.sterilization?"ทำแล้ว":"ยังไม่ทำ"))])]),e._v(" "),n("v-col",{class:e.$vuetify.breakpoint.smAndDown?"order-9":"order-8",attrs:{lg:"8",sm:"12",cols:"12"}},[n("span",{staticClass:"font-weight-medium"},[e._v("สี :")]),e._v(" "),n("span",{staticClass:"font-weight-light"},[e._v(e._s(t.color))])]),e._v(" "),n("v-col",{class:e.$vuetify.breakpoint.smAndDown?"order-6":"order-11",attrs:{lg:"4",sm:"6",cols:"6"}},[n("span",{staticClass:"font-weight-medium"},[e._v("ตำหนิ :")]),e._v(" "),n("span",{staticClass:"font-weight-light"},[e._v(e._s(t.earmark))])]),e._v(" "),n("v-col",{class:e.$vuetify.breakpoint.smAndDown?"order-8":"order-12",attrs:{lg:"4",sm:"6",cols:"6"}},[n("span",{staticClass:"font-weight-medium"},[e._v("Microchip No :")]),e._v(" "),n("span",{staticClass:"font-weight-light"},[e._v(e._s(t.microchipNo))])]),e._v(" "),n("v-col",{class:e.$vuetify.breakpoint.smAndDown?"order-12":"order-6",attrs:{lg:"4",sm:"6",cols:"6"}},[n("span",{staticClass:"font-weight-medium"},[e._v("นัดหมายครั้งต่อไป :")]),e._v(" "),n("span",{staticClass:"font-weight-light"},[e._v("\n                  "+e._s(""===t.nextAppoint?"":e.$moment(t.nextAppoint).format("DD/MM/YYYY"))+"\n                ")])])],1)],1),e._v(" "),n("v-col",{attrs:{lg:"1",md:"2",cols:"6"}},[n("v-btn",{staticClass:"ma-2 px-0",attrs:{disabled:t.death,color:"cusblue3 white--text",block:"",depressed:""},on:{click:function(n){return e.onClickCheck(t.id)}}},[e._v("\n              ส่งตรวจ\n            ")]),e._v(" "),n("v-btn",{staticClass:"ma-2 px-0",attrs:{disabled:t.death,color:"cusblue3 white--text",block:"",depressed:""},on:{click:function(n){return e.onClickDepo(t.id)}}},[e._v("\n              ฝากเลี้ยง\n            ")]),e._v(" "),n("v-btn",{staticClass:"ma-2 px-0",attrs:{disabled:t.death,color:"cusblue3 white--text",block:"",depressed:""},on:{click:function(n){return e.onClickApp(t.id)}}},[e._v("\n              ทำนัด\n            ")]),e._v(" "),n("v-btn",{staticClass:"ma-2 px-0",attrs:{color:"cusblue3 white--text",block:"",depressed:"",to:"/history/"+t.id}},[e._v("\n              ประวัติการรักษา\n            ")])],1)],1),e._v(" "),n("v-divider")],1)})),e._v(" "),n("sendcheckDialog",{ref:"checkDialog"}),e._v(" "),n("depositDialog",{ref:"depoDialog"}),e._v(" "),n("appointDialog",{ref:"appDialog",on:{updateAppoint:e.updateAppoint}}),e._v(" "),n("confirmDialog",{ref:"confirm"}),e._v(" "),n("sendOwnerDialog",{ref:"sendOwnerDialog",on:{removePet:e.updateOwner}})],2):n("div",{staticClass:"text-center pa-15 grey--text"},[e._v("Not Found Pet")])],1)],1)}),[],!1,null,null,null),le=ie.exports;d()(ie,{VBtn:D.a,VCard:w.a,VCardTitle:y.d,VCol:v.a,VDivider:C.a,VIcon:$.a,VList:O.a,VListItem:V.a,VMenu:A.a,VRow:m.a});n(571),n(51);var ce=n(15),de=(n(21),{data:function(){return{assignModal:!1,menuDate:!1,valid:!0,loading:!1,alert:!1,error:"",date:null,dateFormatted:"",dateYear:"",dateMonth:"",dateDay:"",formData:{id:null,name:"",microship:"",type:1,gender:1,color:"",sterile:2,breed:"",scar:"",note:""},rules:{name:[function(e){return!!e||"กรุณากรอกชื่อสัตว์เลี้ยง"},function(e){return e&&e.length<=100||"ไม่ควรกรอกชื่อเกิน 100 ตัวอักษร"}],bd:[function(e){return!!e||"กรุณาเลือกวันเกิดของสัตว์เลี้ยง"}],type:[function(e){return!!e||"กรุณาเลือกประเภทสัตว์เลี้ยง"}],gender:[function(e){return!!e||"กรุณาเลือกเพศสัตว์เลี้ยง"}],breed:[function(e){return e.length<=100||"ไม่ควรกรอกพันธุ์เกิน 100 ตัวอักษร"}],color:[function(e){return e.length<=100||"ไม่ควรกรอกสีเกิน 100 ตัวอักษร"}],sterile:[function(e){return!!e||"กรุณาเลือกการทำหมัน"}],scar:[function(e){return e.length<=1e3||"ไม่ควรกรอกตำหนิเกิน 1000 ตัวอักษร"}],note:[function(e){return e.length<=2e3||"ไม่ควรกรอกโน๊ตเกิน 2000 ตัวอักษร"}]}}},computed:{type:function(){return this.$store.state.form.petType},gender:function(){return this.$store.state.form.petGender},sterile:function(){return[{state:1,label:"ทำแล้ว"},{state:2,label:"ยังไม่ทำ"}]}},watch:{date:function(e){this.dateFormatted=this.formatDate(this.date)},assignModal:function(){!1===this.assignModal&&this.resetPet()}},mounted:function(){0===this.$store.state.form.petGender.length&&this.$store.dispatch("form/addGender"),0===this.$store.state.form.petType.length&&this.$store.dispatch("form/addType")},methods:{open:function(e){this.assignModal=!0,e&&(this.formData={id:e.id,name:e.name||"",microship:e.microchipNo||"",type:e.type.id,gender:e.gender.id,color:e.color||"",sterile:e.sterilization?1:2,breed:e.breed||"",scar:e.earmark||"",note:e.note||""},this.date=e.birthDate)},onEnter:function(e){this.$refs[e].focus()},setDate:function(){var e=E()();e=E()(e).subtract(this.dateYear,"years"),e=E()(e).subtract(this.dateMonth,"months"),e=E()(e).subtract(this.dateDay,"days"),this.date=E()(e).format("YYYY-MM-DD")},formatDate:function(e){if(!e)return null;this.calcDate(e);var t=e.split("-"),n=Object(ce.a)(t,3),o=n[0],r=n[1],l=n[2];return"".concat(l,"/").concat(r,"/").concat(o)},parseDate:function(e){if(!e)return null;var t=e.split("/"),n=Object(ce.a)(t,3),o=n[0],r=n[1],l=n[2];return"".concat(l,"-").concat(r.padStart(2,"0"),"-").concat(o.padStart(2,"0"))},calcDate:function(e){var t=E()(),n=E()(e.toString(),"YYYY-MM-DD"),o=E.a.duration(t.diff(n));this.dateYear=o.years(),this.dateMonth=o.months(),this.dateDay=o.days()},onSubmit:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var body,n,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.$refs.form.validate()){t.next=27;break}if(e.loading=!0,body={name:e.formData.name,breed:e.formData.breed,color:e.formData.color,sterilization:1===e.formData.sterile||2!==e.formData.sterile&&"",ownerId:e.$route.params.owner,genderId:e.formData.gender,typeId:e.formData.type,birthDate:e.date,earmark:e.formData.scar,note:e.formData.note,microchipNo:e.formData.microship},n=!e.formData.id,t.prev=4,o=null,!n){t.next=12;break}return t.next=9,e.$axios.$post("/api/pets",body,{progress:!1});case 9:o=t.sent,t.next=15;break;case 12:return t.next=14,e.$axios.$patch("/api/pets/".concat(e.formData.id),body,{progress:!1});case 14:o=t.sent;case 15:e.loading=!1,e.alert=!1,e.assignModal=!1,e.resetPet(),e.$emit("update",o),t.next=27;break;case 22:t.prev=22,t.t0=t.catch(4),e.loading=!1,e.alert=!0,e.error=t.t0.response?t.t0.response.data.error.message:t.t0.message;case 27:case"end":return t.stop()}}),t,null,[[4,22]])})))()},cancelForm:function(){this.resetPet(),this.assignModal=!1},resetPet:function(){this.date=null,this.dateFormatted="",this.dateYear="",this.dateMonth="",this.dateDay="",this.formData={id:null,name:"",microship:"",type:1,gender:1,color:"",sterile:2,breed:"",scar:"",note:""},this.valid=!0,this.$refs.form.resetValidation()}}}),ue=n(522),pe=Object(l.a)(de,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("v-dialog",{attrs:{"max-width":"700",scrollable:"",fullscreen:this.$vuetify.breakpoint.xsOnly},model:{value:e.assignModal,callback:function(t){e.assignModal=t},expression:"assignModal"}},[n("v-card",[n("h2",{staticClass:"pa-5 pb-2"},[e._v("\n        "+e._s(e.formData.id?"แก้ไขข้อมูลสัตว์เลี้ยง":"เพิ่มข้อมูลสัตว์เลี้ยง")+"\n      ")]),e._v(" "),n("v-btn",{staticClass:"mt-4",attrs:{icon:"",absolute:"",right:""},on:{click:function(t){e.assignModal=!1}}},[n("v-icon",[e._v("mdi-close")])],1),e._v(" "),n("v-divider",{staticClass:"darker-divider"}),e._v(" "),n("v-card-text",[n("v-form",{ref:"form",attrs:{"lazy-validation":"",autocomplete:"off"},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[n("div",[n("v-row",{attrs:{dense:""}},[n("v-col",{attrs:{cols:"12"}},[n("v-text-field",{attrs:{disabled:e.loading,color:"cusblue",label:"ชื่อสัตว์เลี้ยง",rules:e.rules.name,autofocus:""},on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onEnter("year")}},model:{value:e.formData.name,callback:function(t){e.$set(e.formData,"name",t)},expression:"formData.name"}})],1),e._v(" "),n("v-col",{attrs:{cols:"4",sm:"2"}},[n("v-text-field",{ref:"year",attrs:{disabled:e.loading,color:"cusblue",label:"ปี"},on:{change:e.setDate,keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onEnter("month")}},model:{value:e.dateYear,callback:function(t){e.dateYear=t},expression:"dateYear"}})],1),e._v(" "),n("v-col",{attrs:{cols:"4",sm:"2"}},[n("v-text-field",{ref:"month",attrs:{disabled:e.loading,color:"cusblue",label:"เดือน"},on:{change:e.setDate,keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onEnter("day")}},model:{value:e.dateMonth,callback:function(t){e.dateMonth=t},expression:"dateMonth"}})],1),e._v(" "),n("v-col",{attrs:{cols:"4",sm:"2"}},[n("v-text-field",{ref:"day",attrs:{disabled:e.loading,color:"cusblue",label:"วัน"},on:{change:e.setDate,keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onEnter("type")}},model:{value:e.dateDay,callback:function(t){e.dateDay=t},expression:"dateDay"}})],1),e._v(" "),n("v-col",{attrs:{cols:"12",sm:"6"}},[n("v-menu",{ref:"menuDate",attrs:{"close-on-content-click":!1,transition:"scale-transition","offset-y":"","min-width":"290px"},scopedSlots:e._u([{key:"activator",fn:function(t){var o=t.on,r=t.attrs;return[n("v-text-field",e._g(e._b({ref:"bd",attrs:{disabled:e.loading,label:"วันเกิด",color:"cusblue","append-icon":"mdi-calendar-month",rules:e.rules.bd},on:{blur:function(t){e.date=e.parseDate(e.dateFormatted)},keydown:function(t){if(!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;e.onEnter("type"),e.menuDate=!1}},model:{value:e.dateFormatted,callback:function(t){e.dateFormatted=t},expression:"dateFormatted"}},"v-text-field",r,!1),o))]}}]),model:{value:e.menuDate,callback:function(t){e.menuDate=t},expression:"menuDate"}},[e._v(" "),n("v-date-picker",{ref:"picker",attrs:{disabled:e.loading,color:"cusblue",max:(new Date).toISOString().substr(0,10),min:"1950-01-01",locale:"th-TH","show-current":!1,scrollable:""},on:{input:function(t){e.menuDate=!1}},model:{value:e.date,callback:function(t){e.date=t},expression:"date"}})],1)],1),e._v(" "),n("v-col",{attrs:{cols:"6"}},[n("v-select",{ref:"type",attrs:{disabled:e.loading,items:e.type,"item-text":"label","item-value":"id",label:"ประเภท",rules:e.rules.type},on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onEnter("gender")}},model:{value:e.formData.type,callback:function(t){e.$set(e.formData,"type",t)},expression:"formData.type"}})],1),e._v(" "),n("v-col",{attrs:{cols:"6"}},[n("v-text-field",{ref:"breed",attrs:{disabled:e.loading,color:"cusblue",label:"สายพันธุ์",rules:e.rules.breed},on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onEnter("scar")}},model:{value:e.formData.breed,callback:function(t){e.$set(e.formData,"breed",t)},expression:"formData.breed"}})],1),e._v(" "),n("v-col",{attrs:{cols:"6"}},[n("v-select",{ref:"gender",attrs:{disabled:e.loading,items:e.gender,"item-text":"label","item-value":"id",label:"เพศ",rules:e.rules.gender},on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onEnter("color")}},model:{value:e.formData.gender,callback:function(t){e.$set(e.formData,"gender",t)},expression:"formData.gender"}})],1),e._v(" "),n("v-col",{attrs:{cols:"6"}},[n("v-select",{ref:"sterile",attrs:{disabled:e.loading,items:e.sterile,"item-text":"label","item-value":"state",label:"การทำหมัน",rules:e.rules.sterile},on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onEnter("breed")}},model:{value:e.formData.sterile,callback:function(t){e.$set(e.formData,"sterile",t)},expression:"formData.sterile"}})],1),e._v(" "),n("v-col",{attrs:{cols:"6"}},[n("v-text-field",{ref:"color",attrs:{disabled:e.loading,color:"cusblue",label:"สี",rules:e.rules.color},on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onEnter("sterile")}},model:{value:e.formData.color,callback:function(t){e.$set(e.formData,"color",t)},expression:"formData.color"}})],1),e._v(" "),n("v-col",{attrs:{cols:"6"}},[n("v-text-field",{ref:"scar",attrs:{disabled:e.loading,color:"cusblue",label:"ตำหนิ",rules:e.rules.scar},on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onEnter("note")}},model:{value:e.formData.scar,callback:function(t){e.$set(e.formData,"scar",t)},expression:"formData.scar"}})],1),e._v(" "),n("v-col",{attrs:{cols:"12"}},[n("v-text-field",{ref:"microship",attrs:{disabled:e.loading,color:"cusblue",label:"Microchip No"},on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onEnter("note")}},model:{value:e.formData.microship,callback:function(t){e.$set(e.formData,"microship",t)},expression:"formData.microship"}})],1),e._v(" "),n("v-col",{attrs:{cols:"12"}},[n("v-textarea",{ref:"note",attrs:{disabled:e.loading,color:"cusblue",label:"Note","auto-grow":"","row-height":"24",rows:"1",rules:e.rules.note},model:{value:e.formData.note,callback:function(t){e.$set(e.formData,"note",t)},expression:"formData.note"}})],1)],1)],1),e._v(" "),n("v-alert",{attrs:{dense:"",text:"",color:"red",transition:"scroll-y-transition",dismissible:""},model:{value:e.alert,callback:function(t){e.alert=t},expression:"alert"}},[e._v("\n            "+e._s(e.error)+"\n          ")])],1)],1),e._v(" "),n("v-card-actions",[n("v-spacer"),e._v(" "),n("v-btn",{directives:[{name:"shortkey",rawName:"v-shortkey",value:["ctrl","x"],expression:"['ctrl', 'x']"}],attrs:{color:"cusblue2",disabled:e.loading,text:""},on:{shortkey:e.cancelForm,click:e.cancelForm}},[e._v("\n          ยกเลิก\n        ")]),e._v(" "),n("v-btn",{directives:[{name:"shortkey",rawName:"v-shortkey",value:["ctrl","enter"],expression:"['ctrl', 'enter']"}],attrs:{color:"cusblue2",disabled:!e.valid||e.loading,text:""},on:{shortkey:e.onSubmit,click:e.onSubmit}},[n("v-progress-circular",{directives:[{name:"show",rawName:"v-show",value:e.loading,expression:"loading"}],staticClass:"mr-2",attrs:{indeterminate:"",color:"cusblue2",size:15,width:2}}),e._v("\n          บันทึก\n        ")],1)],1)],1)],1)],1)}),[],!1,null,null,null),ve=pe.exports;d()(pe,{VAlert:N.a,VBtn:D.a,VCard:w.a,VCardActions:y.a,VCardText:y.c,VCol:v.a,VDatePicker:R.a,VDialog:F.a,VDivider:C.a,VForm:z.a,VIcon:$.a,VMenu:A.a,VProgressCircular:B.a,VRow:m.a,VSelect:ue.a,VSpacer:L.a,VTextField:G.a,VTextarea:H.a});var me={components:{userRecordNav:f,ownerCard:I,petCard:le,petDialog:ve},validate:function(e){var t=e.store;return t.getters.loggedInUser.roles.some((function(e){return 1===e.id||2===e.id}))||t.getters.loggedInUser.isAdmin},asyncData:function(e){return Object(o.a)(regeneratorRuntime.mark((function t(){var n,o,r,l,c,d,v;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.$axios,o=e.params,r=o.owner,t.next=4,n.$get("/api/members/".concat(r),{progress:!1});case 4:return l=t.sent,t.next=7,n.$get("/api/pets?ownerId=".concat(r,"&limit=0"),{progress:!1});case 7:c=t.sent,t.t0=regeneratorRuntime.keys(c.results);case 9:if((t.t1=t.t0()).done){t.next=17;break}return d=t.t1.value,t.next=13,n.$get("/api/appoints?petId=".concat(c.results[d].id,"&limit=1"),{progress:!1});case 13:v=t.sent,Object.assign(c.results[d],{nextAppoint:0===v.results.length?"":v.results[0].appointDate}),t.next=9;break;case 17:return t.abrupt("return",{oneMember:l,ownPets:c.results});case 18:case"end":return t.stop()}}),t)})))()},data:function(){return{}},methods:{addPetDialog:function(){this.$refs.addPetDialog.open()},updatePetDialog:function(e){this.$refs.addPetDialog.open(e)},updateMember:function(e){this.oneMember=e},updatePet:function(e){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n,o,r,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.$route.params.owner,e.next=3,t.$axios.$get("/api/pets?ownerId=".concat(n),{progress:!1});case 3:o=e.sent,e.t0=regeneratorRuntime.keys(o.results);case 5:if((e.t1=e.t0()).done){e.next=13;break}return r=e.t1.value,e.next=9,t.$axios.$get("/api/appoints?petId=".concat(o.results[r].id,"&limit=1"),{progress:!1});case 9:l=e.sent,Object.assign(o.results[r],{nextAppoint:0===l.results.length?"":l.results[0].appointDate}),e.next=5;break;case 13:t.ownPets=o.results;case 14:case"end":return e.stop()}}),e)})))()},delPet:function(e){var t=this.ownPets.findIndex((function(t){return t.id===e}));this.ownPets.splice(t,1)}}},fe=Object(l.a)(me,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("userRecordNav",{attrs:{title:e.oneMember.firstName+" "+e.oneMember.lastName}}),e._v(" "),n("div",{staticClass:"custom-container"},[n("ownerCard",{attrs:{owner:e.oneMember},on:{update:e.updateMember}}),e._v(" "),n("div",{staticClass:"pt-5"},[n("petCard",{attrs:{pets:e.ownPets},on:{update:e.updatePetDialog,del:e.delPet}})],1)],1),e._v(" "),n("petDialog",{ref:"addPetDialog",on:{update:e.updatePet}}),e._v(" "),n("v-btn",{directives:[{name:"shortkey",rawName:"v-shortkey",value:["ctrl","alt","n"],expression:"['ctrl', 'alt', 'n']"}],key:e.$nuxt.$route.path,attrs:{color:"cusblue2",fixed:"",fab:"",small:this.$vuetify.breakpoint.mobile,large:!this.$vuetify.breakpoint.mobile,dark:"",bottom:"",right:""},on:{shortkey:e.addPetDialog,click:function(t){return t.stopPropagation(),e.addPetDialog(t)}}},[n("v-icon",[e._v("mdi-plus")])],1)],1)}),[],!1,null,null,null);t.default=fe.exports;d()(fe,{VBtn:D.a,VIcon:$.a})}}]);