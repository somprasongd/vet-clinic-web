(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{487:function(t,e,n){"use strict";n(4);var o={data:function(){return{isShowDialog:!1,resolve:null,reject:null,message:null,title:null,options:{color:"primary",width:290,zIndex:200}}},methods:{open:function(title,t,e){var n=this;return this.isShowDialog=!0,this.$nextTick((function(){return n.$refs.cancelDialog.$el.focus()})),this.title=title,this.message=t,this.options=Object.assign(this.options,e),new Promise((function(t,e){n.resolve=t,n.reject=e}))},agree:function(){this.isShowDialog=!1,this.resolve(!0),this.$emit("onOk")},cancel:function(){this.isShowDialog=!1,this.resolve(!1),this.$emit("onCancel")}}},r=n(41),c=n(50),l=n.n(c),d=n(110),v=n(183),m=n(62),h=n(463),f=n(480),component=Object(r.a)(o,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-dialog",{style:{zIndex:t.options.zIndex},attrs:{"max-width":t.options.width},on:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"esc",27,e.key,["Esc","Escape"])?null:t.cancel(e)}},model:{value:t.isShowDialog,callback:function(e){t.isShowDialog=e},expression:"isShowDialog"}},[n("v-card",[n("h2",{staticClass:"pl-6 pt-3 pb-2"},[t._v(t._s(t.title))]),t._v(" "),n("v-card-text",{directives:[{name:"show",rawName:"v-show",value:!!t.message,expression:"!!message"}]},[t._v(" "+t._s(t.message)+" ")]),t._v(" "),n("v-card-actions",[n("v-spacer"),t._v(" "),n("v-btn",{ref:"btnOk",attrs:{color:t.options.color,text:""},nativeOn:{click:function(e){return t.agree(e)}}},[t._v("\n        ใช่\n      ")]),t._v(" "),n("v-btn",{ref:"cancelDialog",attrs:{color:"grey",text:""},nativeOn:{click:function(e){return t.cancel(e)}}},[t._v("\n        ไม่\n      ")])],1)],1)],1)}),[],!1,null,null,null);e.a=component.exports;l()(component,{VBtn:d.a,VCard:v.a,VCardActions:m.a,VCardText:m.c,VDialog:h.a,VSpacer:f.a})},503:function(t,e,n){"use strict";var o={data:function(){return{sendDoctor:!1,doctor:this.$store.state.form.doctor,visitId:"",oldDoc:"",newDoc:"",loading:!1}},created:function(){var t=this;0===this.$store.state.form.doctor.length&&this.$store.dispatch("form/addDoctor").then((function(e){t.doctor=e}))},methods:{open:function(t,e){this.visitId=e,this.oldDoc=t,this.sendDoctor=!0},submitSend:function(){var t=this;this.loading=!0,this.$axios.$patch("/api/visits/".concat(this.visitId),{doctorId:""===this.newDoc?null:this.newDoc},{progress:!1}).then((function(e){setTimeout((function(){t.sendDoctor=!1,t.loading=!1,t.$emit("updateDoctor",e)}),500)})).catch((function(e){t.loading=!1,alert(e)}))}}},r=n(41),c=n(50),l=n.n(c),d=n(110),v=n(183),m=n(62),h=n(463),f=n(465),k=n(112),x=n(120),_=n(175),C=n(504),y=n(480),w=n(461),component=Object(r.a)(o,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-dialog",{attrs:{"max-width":"450",scrollable:"",fullscreen:this.$vuetify.breakpoint.xsOnly,transition:"dialog-transition"},model:{value:t.sendDoctor,callback:function(e){t.sendDoctor=e},expression:"sendDoctor"}},[n("v-card",[n("h2",{staticClass:"pa-5 pb-2"},[t._v("ส่งต่อ")]),t._v(" "),n("v-divider"),t._v(" "),n("v-card-text",[n("v-text-field",{attrs:{label:"แพทย์ผู้ตรวจ (เดิม)",disabled:""},model:{value:t.oldDoc,callback:function(e){t.oldDoc=e},expression:"oldDoc"}}),t._v(" "),n("v-select",{attrs:{items:t.doctor,"item-text":"name","item-value":"id",color:"cusblue","item-color":"cusblue",label:"แพทย์ผู้ตรวจ (ใหม่)",disabled:t.loading,"menu-props":{closeOnContentClick:!0}},scopedSlots:t._u([{key:"prepend-item",fn:function(){return[n("v-list-item",{style:""===t.newDoc?"background-color: #e2f5fc":"",attrs:{ripple:""},on:{click:function(e){t.newDoc=""}}},[n("v-list-item-content",[n("v-list-item-title",{class:""===t.newDoc?"cusblue--text":""},[t._v("\n                ไม่ระบุแพทย์\n              ")])],1)],1),t._v(" "),n("v-divider",{staticClass:"mt-2"})]},proxy:!0}]),model:{value:t.newDoc,callback:function(e){t.newDoc=e},expression:"newDoc"}})],1),t._v(" "),n("v-card-actions",[n("v-spacer"),t._v(" "),n("v-btn",{attrs:{color:"cusblue2",disabled:t.loading,text:""},on:{click:function(e){t.sendDoctor=!1}}},[t._v("\n        ไม่ส่ง\n      ")]),t._v(" "),n("v-btn",{attrs:{color:"cusblue2",disabled:t.loading,text:""},on:{click:t.submitSend}},[n("v-progress-circular",{directives:[{name:"show",rawName:"v-show",value:t.loading,expression:"loading"}],staticClass:"mr-2",attrs:{indeterminate:"",color:"cusblue2",size:15,width:2}}),t._v("\n        ยืนยัน\n      ")],1)],1)],1)],1)}),[],!1,null,null,null);e.a=component.exports;l()(component,{VBtn:d.a,VCard:v.a,VCardActions:m.a,VCardText:m.c,VDialog:h.a,VDivider:f.a,VListItem:k.a,VListItemContent:x.a,VListItemTitle:x.b,VProgressCircular:_.a,VSelect:C.a,VSpacer:y.a,VTextField:w.a})},534:function(t,e,n){"use strict";n(11),n(9),n(6),n(4),n(10);var o=n(1);n(51);function r(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}var c={data:function(){return{sendCheckDialog:!1,loading:!1,alert:!1,error:"",sendCheck:{petId:"",type:"",time:"",status:"",doctorId:"",important:1,weight:"",temp:"",do:{check:[],other:{text:"",enabled:!1}},problem:"",appointId:""},valid:!0,rules:{important:[function(t){return!!t||"กรุณาเลือกความสำคัญ"}],weight:[function(t){return!!t||"กรุณากรอกน้ำหนัก"},function(t){return/^[0-9]*\.?[0-9]{1,2}$/.test(t)||"กรุณากรอกตัวเลขเท่านั้น"},function(t){return t&&t.split(".")[0].length<=3||"ไม่ควรกรอกน้ำหนักเกิน 3 หลัก"}],temp:[function(t){return!t||/^[0-9]*\.?[0-9]{1,2}$/.test(t)||"กรุณากรอกตัวเลขเท่านั้น"},function(t){return!t||t.split(".")[0].length<=3||"ไม่ควรกรอกอุณหภูมิเกิน 3 หลัก"}]}}},computed:{doctorListItems:function(){return this.$store.state.form.doctor},priorityListItems:function(){return this.$store.state.form.priority}},watch:{sendCheckDialog:function(){!1===this.sendCheckDialog&&this.$refs.form.reset()}},mounted:function(){0===this.$store.state.form.doctor.length&&this.$store.dispatch("form/addDoctor"),0===this.$store.state.form.priority.length&&this.$store.dispatch("form/addPriority")},methods:{open:function(t){this.sendCheck.petId=t,this.sendCheck.doctorId=this.$store.getters.loggedInUser.roles.some((function(t){return 2===t.id}))?this.$store.getters.loggedInUser.id:"",this.sendCheck.appointId=null,this.sendCheckDialog=!0},openWithAppointment:function(t,e,n){this.sendCheck.petId=t,this.sendCheck.doctorId=null!==e?e:"",this.sendCheck.appointId=n,this.sendCheckDialog=!0},submitCheck:function(){var t=this;if(this.$refs.form.validate()){this.loading=!0;var e=function(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?r(Object(source),!0).forEach((function(e){Object(o.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):r(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}({},this.sendCheck);e.do.other.enabled&&""!==e.do.other.text&&e.do.check.push(e.do.other.text);var n={petId:e.petId,doctorId:""===e.doctorId?null:e.doctorId,visitPriorityId:e.important,weight:e.weight,temp:""===e.temp?null:e.temp,visitCause:e.do.check.join(", "),note:e.problem,appointId:""===e.appointId?null:e.appointId};this.$axios.$post("/api/visits",n,{progress:!1}).then((function(n){setTimeout((function(){t.loading=!1,t.alert=!1,t.sendCheckDialog=!1,""!==e.appointId&&t.$emit("updateAppoint",{appointId:e.appointId,respone:n})}),500)})).catch((function(e){t.loading=!1,t.alert=!0,t.error=e.response.data.error.message}))}}}},l=n(41),d=n(50),v=n.n(d),m=n(486),h=n(110),f=n(183),k=n(62),x=n(477),_=n(473),C=n(463),y=n(465),w=n(479),D=n(184),I=n(112),$=n(120),V=n(175),S=n(475),O=n(504),T=n(480),j=n(461),N=n(626),component=Object(l.a)(c,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("v-dialog",{attrs:{"max-width":"700",scrollable:"",fullscreen:this.$vuetify.breakpoint.xsOnly},model:{value:t.sendCheckDialog,callback:function(e){t.sendCheckDialog=e},expression:"sendCheckDialog"}},[n("v-card",[n("h2",{staticClass:"pa-5 pb-2"},[t._v("ส่งตรวจ")]),t._v(" "),n("v-btn",{staticClass:"mt-4",attrs:{icon:"",absolute:"",right:""},on:{click:function(e){t.sendCheckDialog=!1}}},[n("v-icon",[t._v("mdi-close")])],1),t._v(" "),n("v-divider",{staticClass:"darker-divider"}),t._v(" "),n("v-card-text",[n("v-form",{ref:"form",attrs:{"lazy-validation":"",autocomplete:"off"},model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[n("v-row",{attrs:{dense:""}},[n("v-col",{attrs:{cols:"6"}},[n("v-select",{attrs:{disabled:t.loading,items:t.doctorListItems,"item-text":"name","item-value":"id",color:"cusblue","item-color":"cusblue",label:"แพทย์ผู้ตรวจ","menu-props":{closeOnContentClick:!0}},scopedSlots:t._u([{key:"prepend-item",fn:function(){return[n("v-list-item",{style:""===t.sendCheck.doctorId?"background-color: #e2f5fc":"",attrs:{ripple:""},on:{click:function(e){t.sendCheck.doctorId=""}}},[n("v-list-item-content",[n("v-list-item-title",{class:""===t.sendCheck.doctorId?"cusblue--text":""},[t._v("\n                        ไม่ระบุแพทย์\n                      ")])],1)],1),t._v(" "),n("v-divider",{staticClass:"mt-2"})]},proxy:!0}]),model:{value:t.sendCheck.doctorId,callback:function(e){t.$set(t.sendCheck,"doctorId",e)},expression:"sendCheck.doctorId"}})],1),t._v(" "),n("v-col",{attrs:{cols:"6"}},[n("v-select",{attrs:{disabled:t.loading,items:t.priorityListItems,"item-text":"label","item-value":"id",color:"cusblue",label:"ความสำคัญ","menu-props":"auto",rules:t.rules.important},model:{value:t.sendCheck.important,callback:function(e){t.$set(t.sendCheck,"important",e)},expression:"sendCheck.important"}})],1),t._v(" "),n("v-col",{attrs:{cols:"6"}},[n("v-text-field",{attrs:{disabled:t.loading,color:"cusblue",label:"นำหนัก / kg",autofocus:"",rules:t.rules.weight},model:{value:t.sendCheck.weight,callback:function(e){t.$set(t.sendCheck,"weight",e)},expression:"sendCheck.weight"}})],1),t._v(" "),n("v-col",{attrs:{cols:"6"}},[n("v-text-field",{attrs:{disabled:t.loading,color:"cusblue",label:"อุณหภูมิ / F°",rules:t.rules.temp},model:{value:t.sendCheck.temp,callback:function(e){t.$set(t.sendCheck,"temp",e)},expression:"sendCheck.temp"}})],1),t._v(" "),n("v-col",{attrs:{cols:"6",sm:"4"}},[n("v-checkbox",{staticClass:"mx-2",attrs:{disabled:t.loading,value:"ดูอาการ",label:"ดูอาการ"},model:{value:t.sendCheck.do.check,callback:function(e){t.$set(t.sendCheck.do,"check",e)},expression:"sendCheck.do.check"}})],1),t._v(" "),n("v-col",{attrs:{cols:"6",sm:"4"}},[n("v-checkbox",{staticClass:"mx-2",attrs:{disabled:t.loading,value:"ทำแผล",label:"ทำแผล"},model:{value:t.sendCheck.do.check,callback:function(e){t.$set(t.sendCheck.do,"check",e)},expression:"sendCheck.do.check"}})],1),t._v(" "),n("v-col",{attrs:{cols:"6",sm:"4"}},[n("v-checkbox",{staticClass:"mx-2",attrs:{disabled:t.loading,value:"ฟังผลตรวจ",label:"ฟังผลตรวจ Lab"},model:{value:t.sendCheck.do.check,callback:function(e){t.$set(t.sendCheck.do,"check",e)},expression:"sendCheck.do.check"}})],1),t._v(" "),n("v-col",{attrs:{cols:"6",sm:"4"}},[n("v-checkbox",{staticClass:"mx-2",attrs:{disabled:t.loading,value:"ฉีดยา",label:"ฉีดยา"},model:{value:t.sendCheck.do.check,callback:function(e){t.$set(t.sendCheck.do,"check",e)},expression:"sendCheck.do.check"}})],1),t._v(" "),n("v-col",{attrs:{cols:"6",sm:"4"}},[n("v-checkbox",{staticClass:"mx-2",attrs:{disabled:t.loading,value:"ให้น้ำเกลือ",label:"ให้น้ำเกลือ"},model:{value:t.sendCheck.do.check,callback:function(e){t.$set(t.sendCheck.do,"check",e)},expression:"sendCheck.do.check"}})],1),t._v(" "),n("v-col",{attrs:{cols:"6",sm:"4"}},[n("v-checkbox",{staticClass:"mx-2",attrs:{disabled:t.loading,value:"Xray / Ultrasound",label:"Xray / Ultrasound"},model:{value:t.sendCheck.do.check,callback:function(e){t.$set(t.sendCheck.do,"check",e)},expression:"sendCheck.do.check"}})],1),t._v(" "),n("v-col",{staticClass:"px-3",attrs:{cols:"12"}},[n("v-row",{attrs:{align:"center","no-gutters":""}},[n("v-checkbox",{staticClass:"shrink mr-2 mt-0",attrs:{disabled:t.loading,"hide-details":"",label:"อื่นๆ"},model:{value:t.sendCheck.do.other.enabled,callback:function(e){t.$set(t.sendCheck.do.other,"enabled",e)},expression:"sendCheck.do.other.enabled"}}),t._v(" "),n("v-text-field",{staticClass:"mt-5",attrs:{color:"cusblue",dense:"",disabled:!t.sendCheck.do.other.enabled||t.loading},model:{value:t.sendCheck.do.other.text,callback:function(e){t.$set(t.sendCheck.do.other,"text",e)},expression:"sendCheck.do.other.text"}})],1)],1),t._v(" "),n("v-col",{attrs:{cols:"12"}},[n("v-textarea",{attrs:{disabled:t.loading,color:"cusblue",label:"Note","auto-grow":"","row-height":"24",rows:"1"},model:{value:t.sendCheck.problem,callback:function(e){t.$set(t.sendCheck,"problem",e)},expression:"sendCheck.problem"}})],1)],1),t._v(" "),n("v-alert",{attrs:{dense:"",text:"",color:"red",transition:"scroll-y-transition",dismissible:""},model:{value:t.alert,callback:function(e){t.alert=e},expression:"alert"}},[t._v("\n            "+t._s(t.error)+"\n          ")])],1)],1),t._v(" "),n("v-card-actions",[n("v-spacer"),t._v(" "),n("v-btn",{directives:[{name:"shortkey",rawName:"v-shortkey",value:["ctrl","x"],expression:"['ctrl', 'x']"}],attrs:{color:"cusblue2",disabled:t.loading,text:""},on:{shortkey:function(e){t.sendCheckDialog=!1},click:function(e){t.sendCheckDialog=!1}}},[t._v("\n          ยกเลิก\n        ")]),t._v(" "),n("v-btn",{directives:[{name:"shortkey",rawName:"v-shortkey",value:["ctrl","enter"],expression:"['ctrl', 'enter']"}],attrs:{color:"cusblue2",disabled:!t.valid||t.loading,text:""},on:{shortkey:t.submitCheck,click:t.submitCheck}},[n("v-progress-circular",{directives:[{name:"show",rawName:"v-show",value:t.loading,expression:"loading"}],staticClass:"mr-2",attrs:{indeterminate:"",color:"cusblue2",size:15,width:2}}),t._v("\n          บันทึก\n        ")],1)],1)],1)],1)],1)}),[],!1,null,null,null);e.a=component.exports;v()(component,{VAlert:m.a,VBtn:h.a,VCard:f.a,VCardActions:k.a,VCardText:k.c,VCheckbox:x.a,VCol:_.a,VDialog:C.a,VDivider:y.a,VForm:w.a,VIcon:D.a,VListItem:I.a,VListItemContent:$.a,VListItemTitle:$.b,VProgressCircular:V.a,VRow:S.a,VSelect:O.a,VSpacer:T.a,VTextField:j.a,VTextarea:N.a})},628:function(t,e,n){"use strict";n.r(e);n(122),n(42);var o=n(7),r=(n(17),{props:{queueCount:{type:Number,required:!1,default:0},defaultVisitTypeId:{type:Number,required:!1,default:0},defaultDoctorId:{type:Number,required:!1,default:0}},data:function(){return{selectedVisitTypeId:this.defaultVisitTypeId,selectedDoctorId:this.defaultDoctorId}},computed:{visitTypes:function(){return this.$store.state.form.visitType},doctors:function(){return this.$store.state.form.doctor}},created:function(){0===this.$store.state.form.doctor.length&&this.$store.dispatch("form/addDoctor"),0===this.$store.state.form.visitType.length&&this.$store.dispatch("form/addVisitType")},methods:{sendValue:function(){this.$emit("onSearch",{visitTypeId:this.selectedVisitTypeId,doctorId:this.selectedDoctorId})}}}),c=n(41),l=n(50),d=n.n(l),v=n(183),m=n(465),h=n(112),f=n(120),k=n(475),x=n(504),_=n(480),C=n(523),component=Object(c.a)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-card",{attrs:{color:"grey lighten-4",flat:"",tile:""}},[n("v-row",{class:"second-nav cusblue1 "+(this.$vuetify.breakpoint.xsOnly?"pb-2":""),attrs:{height:"55",align:"center",justify:"center",dense:"",flat:""}},[n("h1",{staticClass:"font-weight-medium col-sm-2 col-12"},[t._v("คิว ("+t._s(t.queueCount)+")")]),t._v(" "),n("v-spacer"),t._v(" "),n("v-subheader",{directives:[{name:"show",rawName:"v-show",value:!this.$vuetify.breakpoint.smAndDown,expression:"!this.$vuetify.breakpoint.smAndDown"}],staticClass:"cus-subhead"},[t._v("ประเภทการตรวจ :\n    ")]),t._v(" "),n("v-select",{staticClass:"rounded-lg cus-input mr-3",attrs:{items:t.visitTypes,"item-text":"label","item-value":"id","background-color":"cusblue3","item-color":"cusblue",dark:"",filled:"",rounded:"","single-line":"",dense:"",flat:"","hide-details":""},on:{change:t.sendValue},model:{value:t.selectedVisitTypeId,callback:function(e){t.selectedVisitTypeId=e},expression:"selectedVisitTypeId"}}),t._v(" "),n("v-subheader",{directives:[{name:"show",rawName:"v-show",value:!this.$vuetify.breakpoint.smAndDown,expression:"!this.$vuetify.breakpoint.smAndDown"}],staticClass:"cus-subhead"},[t._v("แพทย์ผู้ตรวจ :\n    ")]),t._v(" "),n("v-select",{staticClass:"rounded-lg cus-input",attrs:{items:t.doctors,"item-text":"name","item-value":"id","menu-props":{closeOnContentClick:!0},"background-color":"cusblue3","item-color":"cusblue",label:"แสดงทั้งหมด",dark:"",filled:"",rounded:"","single-line":"",dense:"",flat:"","hide-details":""},on:{change:t.sendValue},scopedSlots:t._u([{key:"prepend-item",fn:function(){return[n("v-list-item",{style:0===t.selectedDoctorId?"background-color: #e2f5fc":"",attrs:{ripple:""},on:{click:function(e){t.selectedDoctorId=0},change:t.sendValue}},[n("v-list-item-content",[n("v-list-item-title",{class:0===t.selectedDoctorId?"cusblue--text":""},[t._v("\n              แสดงทั้งหมด\n            ")])],1)],1),t._v(" "),n("v-divider",{staticClass:"mt-2"})]},proxy:!0}]),model:{value:t.selectedDoctorId,callback:function(e){t.selectedDoctorId=e},expression:"selectedDoctorId"}})],1)],1)}),[],!1,null,null,null),y=component.exports;d()(component,{VCard:v.a,VDivider:m.a,VListItem:h.a,VListItemContent:f.a,VListItemTitle:f.b,VRow:k.a,VSelect:x.a,VSpacer:_.a,VSubheader:C.a});var w=n(16),D=n(503),I=n(86),$=n.n(I),V={fetch:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.$axios.$get("/api/config/items/1",{progress:!1});case 3:t.item=e.sent,e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),t.item={};case 9:case"end":return e.stop()}}),e,null,[[0,6]])})))()},fetchOnServer:!1,data:function(){return{item:{},id:null,date:new Date,qty:1,price:0,assignModal:!1,loading:!1}},computed:{visitDate:function(){return $()(this.date).format("DD/MM/YYYY")},visitTime:function(){return $()(this.date).format("HH:mm:ss")},summaryTime:function(){var t=$.a.duration($()().diff(this.date));return"".concat(t.days()," วัน ").concat(t.hours()," ชั่วโมง ").concat(t.minutes()," นาที")}},methods:{open:function(t,e){this.id=t,this.date=e;var n=$.a.duration($()().diff(e)),o=0===n.days()?1:n.days();parseInt(n.hours())>=1&&(o=parseInt(n.days())+1),this.qty=o,this.price=this.item.price||0,this.assignModal=!0},isNumber:function(t){var e=t.keyCode?t.keyCode:t.which;(e<48||e>57)&&t.preventDefault()},takeHome:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var data,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.loading=!0,data={qty:t.qty,price:""===t.price?0:t.price},e.prev=2,e.next=5,t.$axios.$patch("/api/visits/".concat(t.id,"/status/take-home"),data,{progress:!1});case 5:n=e.sent,t.assignModal=!1,t.$emit("onSuccess",t.id),n&&t.$router.push("/pos/".concat(n.id)),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(2),t.loading=!1;case 14:case"end":return e.stop()}}),e,null,[[2,11]])})))()}}},S=n(110),O=n(62),T=n(473),j=n(463),N=n(175),A=n(461),M=Object(c.a)(V,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("v-dialog",{attrs:{"max-width":"450",scrollable:"",fullscreen:this.$vuetify.breakpoint.xsOnly,transition:"dialog-transition"},model:{value:t.assignModal,callback:function(e){t.assignModal=e},expression:"assignModal"}},[n("v-card",[n("h2",{staticClass:"pa-5 pb-2"},[t._v("รับกลับบ้าน")]),t._v(" "),n("v-divider"),t._v(" "),n("v-card-text",[n("v-row",{attrs:{dense:""}},[n("v-col",{attrs:{cols:"6"}},[n("v-text-field",{attrs:{value:t.visitDate,disabled:"",color:"cusblue",label:"วันที่รับฝาก"}})],1),t._v(" "),n("v-col",{attrs:{cols:"6"}},[n("v-text-field",{attrs:{value:t.visitTime,disabled:"",color:"cusblue",label:"เวลารับฝาก"}})],1),t._v(" "),n("v-col",{attrs:{cols:"12"}},[n("v-text-field",{attrs:{value:t.summaryTime,disabled:"",color:"cusblue",label:"สรุประยะเวลา"}})],1),t._v(" "),n("v-col",{attrs:{cols:"6"}},[n("v-text-field",{attrs:{autocomplete:"nope",disabled:t.loading,color:"cusblue",label:"จำนวนวันฝาก"},on:{keypress:function(e){return t.isNumber(e)}},model:{value:t.qty,callback:function(e){t.qty=e},expression:"qty"}})],1),t._v(" "),n("v-col",{attrs:{cols:"6"}},[n("v-text-field",{attrs:{autocomplete:"nope",disabled:t.loading,color:"cusblue",label:"ราคาต่อวัน"},on:{keypress:function(e){return t.isNumber(e)}},model:{value:t.price,callback:function(e){t.price=e},expression:"price"}})],1)],1)],1),t._v(" "),n("v-card-actions",[n("v-spacer"),t._v(" "),n("v-btn",{attrs:{color:"cusblue2",disabled:t.loading,text:""},on:{click:function(e){t.assignModal=!1}}},[t._v("\n          ยกเลิก\n        ")]),t._v(" "),n("v-btn",{attrs:{color:"cusblue2",disabled:t.loading,text:""},on:{click:function(e){return t.takeHome()}}},[n("v-progress-circular",{directives:[{name:"show",rawName:"v-show",value:t.loading,expression:"loading"}],staticClass:"mr-2",attrs:{indeterminate:"",color:"cusblue2",size:15,width:2}}),t._v("\n          ตกลง\n        ")],1)],1)],1)],1)],1)}),[],!1,null,null,null),L=M.exports;d()(M,{VBtn:S.a,VCard:v.a,VCardActions:O.a,VCardText:O.c,VCol:T.a,VDialog:j.a,VDivider:m.a,VProgressCircular:N.a,VRow:k.a,VSpacer:_.a,VTextField:A.a});var P=n(487),F={components:{sendDoctorDialog:D.a,takeHomeDialog:L,confirmDialog:P.a},props:{dessert:{default:null,type:Array,required:!1},loading:{type:Boolean,required:!0,default:!1}},data:function(){return{offset:!1,dialog:!1,sendDoctor:!1,headers:[{text:"ลำดับ",align:"center",sortable:!1,value:"id",class:"font-weight-bold"},{text:"เจ้าของ",value:"name",sortable:!1},{text:"สัตว์เลี้ยง",value:"pet",sortable:!1},{text:"ระยะเวลา",value:"time",sortable:!1},{text:"ความสำคัญ",value:"important",sortable:!1},{text:"แพทย์",value:"doctor",sortable:!1},{text:"สถานะ",value:"status",align:"left",sortable:!1},{text:"Action",value:"action",align:"center",sortable:!1}]}},computed:{},methods:{permission:function(t){var e=this,n=function(n){if(e.$store.getters.loggedInUser.roles.some((function(e){return e.id===t[n]}))||e.$store.getters.loggedInUser.isAdmin)return{v:!0}};for(var o in t){var r=n(o);if("object"===Object(w.a)(r))return r.v}return!1},backHome:function(t,e){this.$refs.takeHomeDialog.open(t,e)},openSendDocs:function(t,e){this.$refs.sendDoctor.open(t,e)},updateSend:function(t){this.$emit("update",t)},removeFromQueue:function(t){this.$emit("delete",t)},orderNum:function(data,t){return data.map((function(t){return t.id})).indexOf(t)+1},getColor:function(t){return 1===t?"rgb(255, 98, 98)":2===t?"rgb(255, 191, 72)":3===t?"rgb(79, 155, 255)":4===t?"rgb(214, 185, 81)":9===t?"rgb(255, 145, 98)":"rgb(87, 243, 87)"},updateStatus:function(t,e,n){var r=this;return Object(o.a)(regeneratorRuntime.mark((function o(){return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,r.$refs.confirm.open("ยืนยัน".concat(2===e?"เข้ารับการตรวจ":3===e?"การรอผลตรวจ":4===e?"การรายงานผล":7===e?"การจบการรับบริการ":8===e&&9===n?"ยกเลิกการฝาก":8===e?"ยกเลิกการรักษา":"การจบการรักษา","?"),"ต้องการยืนยัน".concat(2===e?"เข้ารับการตรวจ":3===e?"การรอผลตรวจ":4===e?"การรายงานผล":7===e?"การจบการรับบริการ":8===e&&9===n?"ยกเลิกการฝากเลี้ยง":8===e?"ยกเลิกการรักษา":"การจบการรักษา","ใช่หรือไม่"),{width:290,color:8===e?"red":3===e?"primary":4===e?"rgb(214, 185, 81)":"green"});case 2:if(o.sent){o.next=5;break}return o.abrupt("return");case 5:return o.prev=5,o.next=8,r.$axios.$patch("/api/visits/".concat(t),{visitStatusId:e},{progress:!1});case 8:2===e?r.$router.push("/queue/".concat(t)):8===e?(r.removeFromQueue(t),r.cancelQueueDialog=!1):r.$emit("updateStatus",{visitId:t,visitStatusId:e}),o.next=14;break;case 11:o.prev=11,o.t0=o.catch(5),alert(o.t0);case 14:case"end":return o.stop()}}),o,null,[[5,11]])})))()},discharge:function(t){var e=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.$refs.confirm.open("ยืนยันการจบการรับชำระ?","ต้องการยืนยันรับชำระเงินใช่หรือไม่",{width:300,color:"green"});case 2:if(n.sent){n.next=5;break}return n.abrupt("return");case 5:return n.prev=5,n.next=8,e.$axios.$patch("/api/visits/".concat(t,"/status/discharge"),null,{progress:!1});case 8:void 0!==(o=n.sent).id&&e.$store.getters.loggedInUser.roles.some((function(t){return 6===t.id}))?e.$router.push("/pos/"+o.id):e.$emit("delete",t),n.next=15;break;case 12:n.prev=12,n.t0=n.catch(5),alert(n.t0);case 15:case"end":return n.stop()}}),n,null,[[5,12]])})))()}}},R=n(464),U=n(639),Q=n(184),E=n(186),H=n(466),z=Object(c.a)(F,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("v-data-table",{staticClass:"elevation-4 overflow-y-auto",attrs:{headers:t.headers,items:t.dessert,loading:t.loading,"disable-pagination":"","hide-default-footer":"","fixed-header":"",height:"calc(100vh - 160px)"},scopedSlots:t._u([{key:"item.id",fn:function(e){var o=e.item;return[n("div",{staticClass:"text-center"},[t._v("\n        "+t._s(t.orderNum(t.dessert,o.id))+"\n      ")])]}},{key:"item.name",fn:function(e){var o=e.item;return[t.permission([2,3,4,5])&&6!==o.visitStatus.id?n("div",{staticClass:"font-weight-medium"},[t.$store.getters.loggedInUser.roles.some((function(t){return 3===t.id||4===t.id||5===t.id}))&&1===o.visitStatus.id&&!t.permission([2])?n("span",[t._v("\n          "+t._s(o.pet.owner.name)+"\n        ")]):n("nuxt-link",{staticClass:"bold-owner text-decoration-none text-truncate",attrs:{to:t.$store.getters.loggedInUser.roles.some((function(t){return 3===t.id||4===t.id||5===t.id}))&&!t.permission([2])?"/queue/"+o.id+"/checklist":"/queue/"+o.id}},[t._v("\n          "+t._s(o.pet.owner.name)+"\n          "),n("v-icon",{attrs:{color:"cusblue2",small:""}},[t._v("mdi-chevron-right")])],1)],1):n("div",[t._v(t._s(o.pet.owner.name))])]}},{key:"item.pet",fn:function(e){var o=e.item;return[n("div",[t._v(t._s(o.pet.name+" ("+o.pet.type+")"))])]}},{key:"item.time",fn:function(e){var o=e.item;return[n("div",[t._v(t._s(t.$moment(o.visitAt).fromNow()))])]}},{key:"item.important",fn:function(e){var o=e.item;return[n("div",[t._v(t._s(o.visitPriority.label))])]}},{key:"item.doctor",fn:function(e){var o=e.item;return[n("div",[t._v(t._s(null!==o.doctor?o.doctor.name:""))])]}},{key:"item.status",fn:function(e){var o=e.item;return[n("v-chip",{attrs:{color:t.getColor(o.visitStatus.id),dark:"",small:"",label:""}},[t._v("\n        "+t._s(o.visitStatus.label)+"\n      ")])]}},{key:"item.action",fn:function(e){var o=e.item;return[n("v-menu",{attrs:{"offset-x":t.offset,"nudge-left":"200"},scopedSlots:t._u([{key:"activator",fn:function(e){var r=e.on,c=e.attrs;return[n("v-btn",t._g(t._b({attrs:{color:"cusblue2 white--text",disabled:1===o.visitStatus.id&&!t.permission([1,2])||2===o.visitStatus.id&&!t.permission([2,3,4])||3===o.visitStatus.id&&!t.permission([2,3,4])||4===o.visitStatus.id&&!t.permission([2,3,4])||6===o.visitStatus.id&&!t.permission([1,2,6]),icon:"",depressed:""}},"v-btn",c,!1),r),[n("v-icon",[t._v("mdi-dots-horizontal-circle")])],1)]}}],null,!0)},[t._v(" "),n("v-list",{attrs:{width:"200"}},[n("v-list-item",[n("h4",[t._v("Action")])]),t._v(" "),n("v-divider"),t._v(" "),1===o.visitType.id||2===o.visitType.id?n("div",[1===o.visitStatus.id?n("div",[!t.permission([2])||null!==o.doctor&&o.doctor.id!==t.$store.getters.loggedInUser.id?t._e():n("v-btn",{staticClass:"cusblue2--text",attrs:{block:"",text:"",tile:""},on:{click:function(e){return t.updateStatus(o.id,2,o.visitStatus.id)}}},[t._v("\n                เข้ารับการตรวจ\n              ")]),t._v(" "),t.permission([1,2])?n("v-btn",{staticClass:"cusblue2--text",attrs:{block:"",text:"",tile:""},on:{click:function(e){return t.openSendDocs(null!==o.doctor?o.doctor.name:"none",o.id)}}},[t._v("\n                ส่งต่อ\n              ")]):t._e(),t._v(" "),t.permission([1,2])?n("v-btn",{staticClass:"cusblue2--text",attrs:{block:"",text:"",tile:""},on:{click:function(e){return t.updateStatus(o.id,8,o.visitStatus.id)}}},[t._v("\n                ยกเลิกการรักษา\n              ")]):t._e()],1):2===o.visitStatus.id?n("div",[t.permission([2,3,4])?n("v-btn",{staticClass:"cusblue2--text",attrs:{block:"",text:"",tile:""},on:{click:function(e){return t.updateStatus(o.id,3,o.visitStatus.id)}}},[t._v("\n                รอผลตรวจ\n              ")]):t._e(),t._v(" "),t.permission([2])?n("v-btn",{staticClass:"cusblue2--text",attrs:{block:"",text:"",tile:""},on:{click:function(e){return t.updateStatus(o.id,6,o.visitStatus.id)}}},[t._v("\n                จบการรักษา\n              ")]):t._e()],1):3===o.visitStatus.id?n("div",[t.permission([2,3,4])?n("v-btn",{staticClass:"cusblue2--text",attrs:{block:"",text:"",tile:""},on:{click:function(e){return t.updateStatus(o.id,4,o.visitStatus.id)}}},[t._v("\n                รายงานผล\n              ")]):t._e(),t._v(" "),t.permission([2])?n("v-btn",{staticClass:"cusblue2--text",attrs:{block:"",text:"",tile:""},on:{click:function(e){return t.updateStatus(o.id,6,o.visitStatus.id)}}},[t._v("\n                จบการรักษา\n              ")]):t._e()],1):4===o.visitStatus.id?n("div",[t.permission([2,3,4])?n("v-btn",{staticClass:"cusblue2--text",attrs:{block:"",text:"",tile:""},on:{click:function(e){return t.updateStatus(o.id,3,o.visitStatus.id)}}},[t._v("\n                รอผลตรวจ\n              ")]):t._e(),t._v(" "),t.permission([2])?n("v-btn",{staticClass:"cusblue2--text",attrs:{block:"",text:"",tile:""},on:{click:function(e){return t.updateStatus(o.id,6,o.visitStatus.id)}}},[t._v("\n                จบการรักษา\n              ")]):t._e()],1):n("div",[t.permission([1,2,6])?n("v-btn",{staticClass:"cusblue2--text",attrs:{block:"",text:"",tile:""},on:{click:function(e){return t.discharge(o.id)}}},[t._v("\n                รับชำระเงิน\n              ")]):t._e(),t._v(" "),t.permission([2])?n("v-btn",{staticClass:"cusblue2--text",attrs:{block:"",text:"",tile:""},on:{click:function(e){return t.updateStatus(o.id,7,o.visitStatus.id)}}},[t._v("\n                จบการรับบริการ\n              ")]):t._e()],1)]):n("div",[t.permission([1,2,6])?n("v-btn",{staticClass:"cusblue2--text",attrs:{block:"",text:"",tile:""},on:{click:function(e){return t.backHome(o.id,o.visitAt)}}},[t._v("\n              รับกลับบ้าน\n            ")]):t._e(),t._v(" "),t.permission([1,2])?n("v-btn",{staticClass:"cusblue2--text",attrs:{block:"",text:"",tile:""},on:{click:function(e){return t.updateStatus(o.id,8,o.visitStatus.id)}}},[t._v("\n              ยกเลิก\n            ")]):t._e()],1)],1)],1)]}}],null,!0)}),t._v(" "),n("sendDoctorDialog",{ref:"sendDoctor",on:{updateDoctor:t.updateSend}}),t._v(" "),n("takeHomeDialog",{ref:"takeHomeDialog",on:{onSuccess:t.removeFromQueue}}),t._v(" "),n("confirmDialog",{ref:"confirm"})],1)}),[],!1,null,null,null),Y=z.exports;d()(z,{VBtn:S.a,VChip:R.a,VDataTable:U.a,VDivider:m.a,VIcon:Q.a,VList:E.a,VListItem:h.a,VMenu:H.a});n(21),n(23),n(26);var B={components:{sendcheckDialog:n(534).a},data:function(){return{assignModal:!1,menuDate:!1,offset:!0,date:null,appointQueue:[],ownerName:""}},computed:{selectDate:function(){return this.date?$()(this.date).format("DD/MM/YYYY"):null},appointFilter:function(){var t=this;return this.appointQueue.filter((function(e){return e.pet.owner.name.toLowerCase().includes(t.ownerName.toLowerCase())}))}},watch:{date:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.$axios.$get("/api/appoints?date=".concat(t.date),{progress:!1});case 3:n=e.sent,t.appointQueue=n.results,e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),alert(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))()}},mounted:function(){this.date=(new Date).toISOString().substr(0,10)},methods:{sendCheck:function(t,e,n){var o=this;this.assignModal=!1,setTimeout((function(){o.$refs.checkDialog.openWithAppointment(t,e,n)}),150)},UpdateAppoint:function(t){var e=this.appointQueue.findIndex((function(e){return e.id===t.appointId}));this.appointQueue.splice(e,1),this.$emit("updateVisit",t.respone)}}},J=n(638),W=n(67),X=Object(c.a)(B,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("v-btn",{directives:[{name:"shortkey",rawName:"v-shortkey",value:["ctrl","alt","a"],expression:"['ctrl', 'alt', 'a']"}],key:t.$nuxt.$route.path,attrs:{color:"cusblue2",fixed:"",fab:"",small:this.$vuetify.breakpoint.mobile,large:!this.$vuetify.breakpoint.mobile,dark:"",bottom:"",right:""},on:{shortkey:function(e){t.assignModal=!0},click:function(e){e.stopPropagation(),t.assignModal=!0}}},[n("v-icon",[t._v("mdi-calendar-month")])],1),t._v(" "),n("v-dialog",{attrs:{"max-width":"450",scrollable:"",fullscreen:this.$vuetify.breakpoint.xsOnly},model:{value:t.assignModal,callback:function(e){t.assignModal=e},expression:"assignModal"}},[n("v-card",[n("h2",{staticClass:"pa-5 pb-2"},[t._v("ตารางนัดหมาย")]),t._v(" "),n("v-btn",{staticClass:"mt-4",attrs:{icon:"",absolute:"",right:""},on:{click:function(e){t.assignModal=!1}}},[n("v-icon",[t._v("mdi-close")])],1),t._v(" "),n("v-divider"),t._v(" "),n("div",{staticClass:"px-10 pb-10"},[n("v-row",{attrs:{align:"center",justify:"center",dense:""}},[n("v-col",{attrs:{cols:"12"}},[n("v-menu",{ref:"menu",attrs:{"close-on-content-click":!1,transition:"scale-transition","offset-y":"","min-width":"290px"},scopedSlots:t._u([{key:"activator",fn:function(e){var o=e.on,r=e.attrs;return[n("v-text-field",t._g(t._b({attrs:{color:"cusblue","append-icon":"mdi-calendar-month","background-color":"white",label:"วันที่นัดหมาย",readonly:"","hide-details":""},model:{value:t.selectDate,callback:function(e){t.selectDate=e},expression:"selectDate"}},"v-text-field",r,!1),o))]}}]),model:{value:t.menuDate,callback:function(e){t.menuDate=e},expression:"menuDate"}},[t._v(" "),n("v-date-picker",{ref:"picker",attrs:{color:"cusblue",min:"1950-01-01",locale:"th"},model:{value:t.date,callback:function(e){t.date=e},expression:"date"}})],1)],1),t._v(" "),n("v-col",{attrs:{cols:"12"}},[n("v-text-field",{attrs:{color:"cusblue","background-color":"white",label:"ชื่อ","hide-details":""},model:{value:t.ownerName,callback:function(e){t.ownerName=e},expression:"ownerName"}})],1)],1)],1),t._v(" "),n("v-divider",{staticClass:"darker-divider"}),t._v(" "),n("v-card-text",{staticClass:"pa-0",staticStyle:{height:"350px"}},[0!==t.appointQueue.length&&t.appointQueue!==[]?n("div",t._l(t.appointFilter,(function(e){return n("v-menu",{key:e.id,attrs:{"offset-x":t.offset,"max-width":"200"},scopedSlots:t._u([{key:"activator",fn:function(o){var r=o.on,c=o.attrs;return[n("v-list-item",t._g(t._b({staticClass:"py-5 px-10",staticStyle:{"border-bottom":"1px solid rgb(204, 204, 204)"},attrs:{link:""}},"v-list-item",c,!1),r),[n("v-row",{attrs:{align:"center",justify:"center","no-gutters":""}},[n("v-col",{staticClass:"font-weight-medium",attrs:{cols:"3"}},[t._v("เจ้าของ")]),t._v(" "),n("v-col",{staticClass:"font-weight-medium text-center",attrs:{cols:"1"}},[t._v(":")]),t._v(" "),n("v-col",{staticClass:"font-weight-medium",attrs:{cols:"8"}},[t._v("\n                    "+t._s(e.pet.owner.name)+"\n                  ")]),t._v(" "),n("v-col",{attrs:{cols:"3"}},[t._v("แพทย์")]),t._v(" "),n("v-col",{staticClass:"text-center",attrs:{cols:"1"}},[t._v(":")]),t._v(" "),n("v-col",{attrs:{cols:"8"}},[t._v("\n                    "+t._s(null!==e.doctor?e.doctor.name:"")+"\n                  ")]),t._v(" "),n("v-col",{attrs:{cols:"3"}},[t._v("สัตว์เลี้ยง")]),t._v(" "),n("v-col",{staticClass:"text-center",attrs:{cols:"1"}},[t._v(":")]),t._v(" "),n("v-col",{attrs:{cols:"8"}},[t._v("\n                    "+t._s(e.pet.name+"("+e.pet.type+")")+"\n                  ")]),t._v(" "),n("v-col",{attrs:{cols:"3"}},[t._v("นัดเพื่อ")]),t._v(" "),n("v-col",{staticClass:"text-center",attrs:{cols:"1"}},[t._v(":")]),t._v(" "),n("v-col",{attrs:{cols:"8"}},[t._v(t._s(e.cause))]),t._v(" "),n("v-col",{attrs:{cols:"3"}},[t._v("เวลา")]),t._v(" "),n("v-col",{staticClass:"text-center",attrs:{cols:"1"}},[t._v(":")]),t._v(" "),n("v-col",{attrs:{cols:"8"}},[t._v(t._s(e.appointTime)+" น.")])],1)],1)]}}],null,!0)},[t._v(" "),n("v-list",{staticClass:"pa-0"},[n("div",{staticClass:"px-2 pt-3"},[n("h3",[t._v("ยืนยันเข้ารับบริการ?")]),t._v(" "),n("v-divider"),t._v(" "),n("v-card-actions",{staticClass:"pa-0 pt-2"},[n("v-spacer"),t._v(" "),n("v-btn",{attrs:{color:"cusblue2",text:""},on:{click:function(e){t.dialog=!1}}},[t._v("\n                    ยกเลิก\n                  ")]),t._v(" "),n("v-btn",{attrs:{color:"cusblue2",text:""},on:{click:function(n){return n.stopPropagation(),t.sendCheck(e.pet.id,null!==e.doctor?e.doctor.id:"",e.id)}}},[t._v("\n                    ตกลง\n                  ")])],1)],1)])],1)})),1):n("v-sheet",{attrs:{height:"100%",tile:""}},[n("v-row",{staticClass:"fill-height",attrs:{align:"center",justify:"center","no-gutters":""}},[n("span",{staticClass:"grey--text"},[t._v("Not Found Appoint")])])],1)],1)],1)],1),t._v(" "),n("sendcheckDialog",{ref:"checkDialog",on:{updateAppoint:t.UpdateAppoint}})],1)}),[],!1,null,null,null),G=X.exports;d()(X,{VBtn:S.a,VCard:v.a,VCardActions:O.a,VCardText:O.c,VCol:T.a,VDatePicker:J.a,VDialog:j.a,VDivider:m.a,VIcon:Q.a,VList:E.a,VListItem:h.a,VMenu:H.a,VRow:k.a,VSheet:W.a,VSpacer:_.a,VTextField:A.a});var K={components:{queueNav:y,queueTable:Y,queueDialog:G},validate:function(t){var e=t.store;return e.getters.loggedInUser.roles.some((function(t){return 1===t.id||2===t.id||3===t.id||4===t.id||5===t.id||6===t.id}))||e.getters.loggedInUser.isAdmin},fetch:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return null===(n=t.filter)&&(n={visitTypeId:t.defaultVisitTypeId,doctorId:t.defaultDoctorId}),0===n.doctorId&&delete n.doctorId,e.prev=3,e.next=6,t.$axios.$get("/api/visits",{params:n});case 6:o=e.sent,t.queues=o.results,e.next=13;break;case 10:e.prev=10,e.t0=e.catch(3),t.queues=[];case 13:case"end":return e.stop()}}),e,null,[[3,10]])})))()},fetchOnServer:!1,data:function(){return{filter:null,queues:[],polling:null}},computed:{defaultVisitTypeId:function(){return localStorage.getItem("queueFilters")?JSON.parse(localStorage.getItem("queueFilters")).visitTypeId:1},defaultDoctorId:function(){return localStorage.getItem("queueFilters")?JSON.parse(localStorage.getItem("queueFilters")).doctorId:this.$store.getters.loggedInUser.roles.some((function(t){return 2===t.id}))?this.$store.getters.loggedInUser.id:0}},mounted:function(){this.pollData()},beforeDestroy:function(){clearInterval(this.polling)},methods:{search:function(t){var e=t.visitTypeId,n=t.doctorId;this.filter={visitTypeId:e,doctorId:n},localStorage.setItem("queueFilters",JSON.stringify(this.filter)),this.refresh()},refresh:function(){this.$fetch()},pollData:function(){var t=this;this.polling=setInterval((function(){t.$fetch()}),3e4)},deleteQueue:function(t){var e=this.queues.findIndex((function(e){return e.id===t}));this.queues.splice(e,1)}}},Z=Object(c.a)(K,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("queueNav",{attrs:{"queue-count":t.queues.length,"default-visit-type-id":t.defaultVisitTypeId,"default-doctor-id":t.defaultDoctorId},on:{onSearch:t.search}}),t._v(" "),n("div",{staticClass:"custom-container"},[n("queueTable",{attrs:{dessert:t.queues,loading:t.$fetchState.pending},on:{update:t.refresh,delete:t.deleteQueue,updateStatus:t.refresh}})],1),t._v(" "),n("queueDialog",{on:{updateVisit:t.refresh}})],1)}),[],!1,null,null,null);e.default=Z.exports}}]);